webpackJsonp([0,1],[function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var i=o(1),s=n(i);o(29),o(30),function(){var t=function(){new s["default"]};window.cordova?document.addEventListener("deviceready",t,!1):window.onload=t}()},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(2),r=n(a),l=o(3),c=(n(l),o(4)),u=n(c),d=o(6),h=n(d),f=o(7),p=(n(f),o(8)),v=n(p),y=o(13),m=(n(y),o(14)),w=n(m),b=o(15),x=n(b),g=o(16),_=n(g),C=o(11),A=(n(C),o(17)),D=n(A),T=o(18),P=(n(T),o(19)),I=n(P);o(23);var S=o(27),O=o(28),k=function(){function t(){i(this,t),this.state={player:{},bullets:[],enemies:[],isGameOver:!1,score:0,gameTime:0,lastFire:0,dt:0,lastTime:0,isMobile:window.innerWidth<1024,isTouchable:"ontouchstart"in document,bgImg:null},this.modules={ctx:{},canvas:{},spritesUrl:S,terrainUrl:terrainUrl,starsUrl:starsUrl},this.modules.internals=this.getInternals();var e=this.createUI();this.modules.canvas=e.canvas,this.modules.ctx=e.ctx,this.modules.objects=x["default"],this.modules.AUDIO=e.AUDIO,this.modules.settings={low_performance:localStorage.getItem("low_performance"),music_volume:localStorage.getItem("music_volume"),efx_volume:localStorage.getItem("efx_volume")},this.modules.views=new I["default"](this.modules.internals),console.log(e),this.modules.controls=new u["default"](this.modules.internals),this.modules.collisions=new v["default"](this.modules.internals),this.modules.gameOver=this.gameOver.bind(this),this.modules.reset=this.reset.bind(this),this.modules.tooglePause=this.tooglePause.bind(this),this.modules.resources=r["default"],this.modules.resources.load([S,terrainUrl,starsUrl]),this.modules.resources.onReady(this.init.bind(this))}return s(t,[{key:"createUI",value:function(){var t=document.createElement(navigator.isCocoonJS?"screencanvas":"canvas"),e=t.getContext("2d");t.width=this.state.isMobile?window.innerWidth:1e3,t.height=this.state.isMobile?window.innerHeight:t.width/window.innerWidth*window.innerHeight,document.body.appendChild(t);var o=new Audio;return o.src=O,o.loop=!0,document.body.appendChild(o),o.load(),o.play(),{canvas:t,ctx:e,AUDIO:o}}},{key:"init",value:function(){this.reset(!0),this.state.lastTime=Date.now(),this.modules.AUDIO.play(),this.modules.views.set("menu"),this.loop()}},{key:"loop",value:function(){var t=Date.now();this.state.dt=(t-this.state.lastTime)/1e3,this.update(),this.render(),this.state.lastTime=t,this.state.stop||window.requestAnimationFrame(this.loop.bind(this))}},{key:"gameOver",value:function(){this.state.powerups.resetTouchAreas(),this.state.isGameOver=!0,this.modules.views.set("gameOver")}},{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"tooglePause",value:function(){return this.state.stop=!this.state.stop,this.state.stop?this.modules.AUDIO.pause():(this.state.lastTime=Date.now(),this.loop(),this.modules.AUDIO.play()),this.state.stop}},{key:"updateObjects",value:function(){this.state.player.update();for(var t=this.modules.canvas,e=this.state.enemies,o=this.state.bullets,n=this.state.explosions,i=(this.modules.stars,this.state.gifts),s=this.state.powerups,a=0;a<e.length;)e[a].update(),e[a].state.pos[0]+e[a].modules.sprite.size[0]<0?e.splice(a,1):a++;for(var r=0;r<o.length;){var l=o[r];l.update(),l.state.pos[1]<0||l.state.pos[1]>t.height||l.state.pos[0]>t.width?o.splice(r,1):r++}for(var c=0;c<n.length;)n[c].update(),n[c].modules.sprite.done?n.splice(c,1):c++;this.modules.stars.forEach(function(t){t.update()});for(var u=0;u<i.length;)i[u].update(),i[u].state.expirationTime<this.state.gameTime?i.splice(u,1):u++;this.state.isGameOver||s.update()}},{key:"update",value:function(){var t=this.state.dt;this.state.gameTime+=t,this.modules.controls.handleKeysPress(),this.updateObjects(),!this.state.isGameOver&&Math.random()<1-Math.pow(.999,this.state.gameTime)&&(Math.random()<.3?this.state.enemies.push(this.modules.objects.enemies.johnHardson(this.modules.internals)):this.state.enemies.push(this.modules.objects.enemies.regular(this.modules.internals))),this.modules.collisions.check(),this.modules.views.update()}},{key:"renderObjects",value:function(){this.modules.stars.forEach(function(t){t.render()}),this.state.isGameOver||this.state.player.render(),this.state.enemies.forEach(function(t){t.render()}),this.state.bullets.forEach(function(t){t.render()}),this.state.explosions.forEach(function(t){t.render()}),this.state.gifts.forEach(function(t){t.render()}),this.state.isGameOver||this.state.powerups.render()}},{key:"render",value:function(){var t=this.modules.ctx;if(this.state.bgImg?(t.drawImage(this.state.bgImg,0,0),t.fillStyle="rgba(40,48,68,0.8)"):t.fillStyle="rgba(40,48,68,1)",t.fillRect(0,0,this.modules.canvas.width,this.modules.canvas.height),this.renderObjects(),this.state.isMobile&&!this.state.isGameOver&&this.modules.controls.render(),!this.state.isGameOver){t.save(),t.font="25px sans-serif";var e=t.measureText(this.state.score).width;t.translate(this.modules.canvas.width-e-20,45),t.fillStyle=this.state.score>this.state.highscore?"#f2d749":"#fffafa",t.fillText(this.state.score,0,0),t.restore()}this.modules.views.render()}},{key:"reset",value:function(t){this.state.player=new h["default"](this.modules.internals),this.state.player.state.pos=[50,this.modules.canvas.height/2],this.state.FPS=60,this.state.isGameOver=t,this.state.gameTime=0,this.state.score=0,this.state.highscore=localStorage.getItem("highscore"),this.state.scoreMultiply=1,this.state.bgImg=null,this.state.weapon=new _["default"],this.state.enemies=[],this.state.bullets=[],this.state.explosions=[],this.state.powerups=new D["default"](this.modules.internals),this.state.gifts=[],this.state.giftsLen=0,this.modules.stars=[];for(var e=0;e++<this.modules.canvas.width;)e%6==0&&this.modules.stars.push(new w["default"](this.modules.internals,e))}}]),t}();e["default"]=k},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(){o(this,t),this.resourceCache={},this.loading=[],this.readyCallbacks=[]}return n(t,[{key:"load",value:function(t){var e=this;t instanceof Array?t.forEach(function(t){e._load(t)}):this._load(t)}},{key:"_load",value:function(t){var e=this;return console.log(this),this.resourceCache[t]?this.resourceCache[t]:void!function(){var o=new Image;o.onload=function(){this.resourceCache[t]=o,this.isReady()&&this.readyCallbacks.forEach(function(t){t()})}.bind(e),e.resourceCache[t]=!1,o.src=t}()}},{key:"get",value:function(t){return this.resourceCache[t]}},{key:"isReady",value:function(){var t=!0;for(var e in this.resourceCache)this.resourceCache.hasOwnProperty(e)&&!this.resourceCache[e]&&(t=!1);return t}},{key:"onReady",value:function(t){this.readyCallbacks.push(t)}}]),t}();e["default"]=new i},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(2),r=n(a),l=function(){function t(e,o,n,s,a,r,l){i(this,t),this.pos=o,this.size=n,this.speed="number"==typeof s?s:0,this.frames=a,this._index=0,this.url=e,this.dir=r||"horizontal",this.once=l}return s(t,[{key:"update",value:function(t){this._index+=this.speed*t}},{key:"render",value:function(t){var e=void 0;if(this.speed>0){var o=this.frames.length,n=Math.floor(this._index);if(e=this.frames[n%o],this.once&&n>=o)return void(this.done=!0)}else e=0;var i=this.pos[0],s=this.pos[1];"vertical"==this.dir?s+=e*this.size[1]:i+=e*this.size[0],t.drawImage(r["default"].get(this.url),i,s,this.size[0],this.size[1],0,0,this.size[0],this.size[1])}}]),t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),l=o(3),c=(n(l),o(5)),u=(n(c),function(){function t(e,o){i(this,t),this.externals=e,this.state=this.reset(),this.modules=a({},o),this.bindControls()}return r(t,[{key:"addTouchArea",value:function(t,e,o,n,i,s,a,r){this.state.touchAreas.push({x:e,y:o,w:n,h:i,callbackStart:s,callbackMove:a,callbackEnd:r,actionName:t}),this.state.touches[t]=!1}},{key:"indexOf",value:function(t){for(var e=this.state.touchAreas.length;--e>=0&&this.state.touchAreas[e].actionName!=t;);return e}},{key:"removeTouchArea",value:function(t){("undefined"==typeof t?"undefined":s(t))!=Number&&(t=this.indexOf(t)),t>-1&&this.state.touchAreas.splice(t,1)}},{key:"resetTouchAreas",value:function(){this.state.touchAreas=[]}},{key:"moveStart",value:function(t){this.state.fingerPos=[t.clientX,t.clientY];var e=this.state.fingerPos[0]-this.state.joyPos[0],o=this.state.joyPos[1]-this.state.fingerPos[1];this.state.joyMove=[e,o],e<0?this.tooglePress("LEFT"):this.tooglePress("RIGHT"),o<0?this.tooglePress("DOWN"):this.tooglePress("UP"),this.tooglePress("FIRE")}},{key:"move",value:function(t){this.state.fingerPos=[t.clientX,t.clientY];var e=this.state.fingerPos[0]-this.state.joyPos[0],o=this.state.joyPos[1]-this.state.fingerPos[1];this.state.joyMove=[e,o],(this.state.LEFT&&e>0||this.state.RIGHT&&e<0)&&(this.tooglePress("RIGHT"),this.tooglePress("LEFT")),(this.state.DOWN&&o>0||this.state.UP&&o<0)&&(this.tooglePress("UP"),this.tooglePress("DOWN"))}},{key:"moveEnd",value:function(){this.state.fingerPos=[this.state.joyPos[0],this.state.joyPos[1]],this.state.LEFT&&this.tooglePress("LEFT"),this.state.RIGHT&&this.tooglePress("RIGHT"),this.state.DOWN&&this.tooglePress("DOWN"),this.state.UP&&this.tooglePress("UP"),this.tooglePress("FIRE")}},{key:"addTouchPad",value:function(){this.addTouchArea("MOVE",this.state.joyPos[0]-this.state.joyRad,this.state.joyPos[1]-this.state.joyRad,2*this.state.joyRad,2*this.state.joyRad,this.moveStart.bind(this),this.move.bind(this),this.moveEnd.bind(this))}},{key:"bindControls",value:function(){var t=this,e=function(t,e){var o=!1,n=e.length-1;for(n;n>=0&&!o;){var i=e[n],s=i.clientX,a=i.clientY;s>=t.x&&a>=t.y&&s<=t.x+t.w&&a<=t.y+t.h?o=!0:n--}return n},o=function(t){for(var o=(t.touches.length,0);o<this.state.touchAreas.length;o++){var n=this.state.touchAreas[o];if(!this.state.touches[n.actionName]){var i=e(n,t.touches);i>=0&&(n.callbackStart&&n.callbackStart(t.touches[i]),this.state.touches[n.actionName]=!0)}}},n=function(t){t.preventDefault();for(var o=(t.touches.length,0);o<this.state.touchAreas.length;o++){var n=this.state.touchAreas[o];if(this.state.touches[n.actionName]){var i=e(n,t.touches);i>=0&&n.callbackMove&&n.callbackMove(t.touches[i])}}},i=function(t){var o=this;Object.keys(this.state.touches).forEach(function(n){var i=o.state.touchAreas[o.indexOf(n)];o.state.touches[n]&&e(i,t.touches)==-1&&(o.state.touches[n]=!1,i.callbackEnd&&i.callbackEnd())})},s=function(t,e){var o=e.clientX/window.innerWidth*this.externals.modules.canvas.width,n=e.clientY/window.innerHeight*this.externals.modules.canvas.height;return console.log(o>=t.x+" "+n>=t.y+" "+o<=t.x+t.w+" "+n<=t.y+t.h),o>=t.x&&n>=t.y&&o<=t.x+t.w&&n<=t.y+t.h},a=function(t){console.log(t.clientX/window.innerWidth*this.externals.modules.canvas.width+" "+t.clientY/window.innerHeight*this.externals.modules.canvas.height);for(var e=0;e<this.state.touchAreas.length;e++){var o=this.state.touchAreas[e];console.log(o.x+" "+o.y),this.state.touches[o.actionName]||(console.log("not found"),s.call(this,o,t)&&(console.log("Clicked!"),o.callbackStart&&o.callbackStart(t),this.state.touches[o.actionName]=!0))}},r=function(t){for(var e=!1,o=0;o<this.state.touchAreas.length&&!e;o++){var n=this.state.touchAreas[o];s.call(this,n,t)&&(this.externals.modules.canvas.style.cursor="pointer",e=!0)}e||(this.externals.modules.canvas.style.cursor="initial")},l=function(t){var e=this;console.log(this.state.touches),Object.keys(this.state.touches).forEach(function(t){var o=e.state.touchAreas[e.indexOf(t)];e.state.touches[t]&&(e.state.touches[t]=!1,o.callbackEnd&&o.callbackEnd())})};if(this.externals.state.isTouchable)this.addTouchPad(),this.externals.modules.canvas.addEventListener("touchstart",o.bind(this)),this.externals.modules.canvas.addEventListener("touchend",i.bind(this)),this.externals.modules.canvas.addEventListener("touchmove",n.bind(this));else{var c=function(t,e){switch(e.code){case"Space":this.state.FIRE!=t&&this.tooglePress("FIRE");break;case"ArrowUp":this.state.UP!=t&&this.tooglePress("UP");break;case"ArrowDown":this.state.DOWN!=t&&this.tooglePress("DOWN");break;case"ArrowLeft":this.state.LEFT!=t&&this.tooglePress("LEFT");break;case"ArrowRight":this.state.RIGHT!=t&&this.tooglePress("RIGHT")}};window.addEventListener("keydown",c.bind(this,!0)),window.addEventListener("keyup",c.bind(this,!1)),Object.keys(this.modules).forEach(function(e,o){t.modules[e].classList.add("disappear")}),this.externals.modules.canvas.addEventListener("mousedown",a.bind(this)),this.externals.modules.canvas.addEventListener("mousemove",r.bind(this)),this.externals.modules.canvas.addEventListener("mouseup",l.bind(this))}}},{key:"hideControls",value:function(){}},{key:"handleUP",value:function(){var t=this.externals.state.isMobile?this.state.joyMove[1]/this.state.joyRad:1;this.externals.state.player.state.pos[1]-=this.externals.state.player.state.speed*t*this.externals.state.dt}},{key:"handleDOWN",value:function(){var t=this.externals.state.isMobile?-this.state.joyMove[1]/this.state.joyRad:1;this.externals.state.player.state.pos[1]+=this.externals.state.player.state.speed*t*this.externals.state.dt}},{key:"handleRIGHT",value:function(){var t=this.externals.state.isMobile?this.state.joyMove[0]/this.state.joyRad:1;this.externals.state.player.state.pos[0]+=this.externals.state.player.state.speed*t*this.externals.state.dt}},{key:"handleLEFT",value:function(){var t=this.externals.state.isMobile?-this.state.joyMove[0]/this.state.joyRad:1;this.externals.state.player.state.pos[0]-=this.externals.state.player.state.speed*t*this.externals.state.dt}},{key:"handleFIRE",value:function(){if(!this.externals.state.isGameOver&&Date.now()-this.externals.state.lastFire>this.externals.state.weapon.deltaLimit){var t=this.externals.state.player.state.pos[0]+this.externals.state.player.modules.sprite.size[0]-5,e=this.externals.state.player.state.pos[1]+this.externals.state.player.modules.sprite.size[1]/2-3,o=this.externals.state.weapon.current;this.externals.state.bullets.push(this.externals.modules.objects.bullets[o](this.externals,[t,e])),this.externals.state.lastFire=Date.now()}}},{key:"handleKeysPress",value:function(){this.state.UP&&this.handleUP(),this.state.DOWN&&this.handleDOWN(),this.state.LEFT&&this.handleLEFT(),this.state.RIGHT&&this.handleRIGHT(),this.state.FIRE&&this.handleFIRE()}},{key:"tooglePress",value:function(t,e){var o=this;"WINDOW"===t&&e.target!==this.externals.modules.canvas||!function(){o.state[t]="WINDOW"===t||!o.state[t];var e="LEFT"==t?-10:40;"LEFT"!==t&&"RIGHT"!==t||(o.state[t]?o.externals.modules.stars.forEach(function(t){t.changeSpeed(e)}):o.externals.modules.stars.forEach(function(t){t.restoreSpeed()}))}()}},{key:"untoogleAll",value:function(t){t.target!=this.externals.modules.canvas||this.state.WINDOW||(this.state=this.reset())}},{key:"update",value:function(){}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.strokeStyle="rgba(255,255,255,0.1)",t.lineWidth=3,t.beginPath(),t.arc(this.state.joyPos[0],this.state.joyPos[1],this.state.joyRad,0,2*Math.PI),t.stroke(),t.fillStyle="rgba(255,255,255,0.1)",t.beginPath(),t.arc(this.state.fingerPos[0],this.state.fingerPos[1],this.state.fingerRad,0,2*Math.PI),t.fill(),t.restore()}},{key:"renderTouchAreas",value:function(){var t=this.externals.modules.ctx;t.save(),t.strokeStyle="green",t.fillStyle="rgba(255,255,0,0.1)",this.state.touchAreas.forEach(function(e){t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.fill(),t.stroke()}),t.restore()}},{key:"reset",value:function(){var t=70,e=5;return this.externals.state.isMobile?{touchAreas:[],joyRad:t,joyPos:[t+e,this.externals.modules.canvas.height-t-e],fingerRad:15,fingerPos:[t+e,this.externals.modules.canvas.height-t-e],joyMove:[0,0],firePos:[this.externals.modules.canvas.width,this.externals.modules.canvas.height],fireRad:120,touches:{}}:{UP:!1,DOWN:!1,RIGHT:!1,LEFT:!1,FIRE:!1,WINDOW:!1,touchAreas:[],touches:{}}}}]),t}());e["default"]=u},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=(n(a),function(){function t(e,o,n,s,a,r){i(this,t),this.externals=e,this.state={},this.modules={},this.state.pos=o,this.state.dir=n,this.state.speed=a||500,this.state.power=s||1,this.modules.sprite=r}return s(t,[{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"update",value:function(){var t=this.externals.state.dt;switch(this.state.dir){case"up":this.state.pos[1]-=this.state.speed*t;break;case"down":this.state.pos[1]+=this.state.speed*t;break;default:this.state.pos[0]+=this.state.speed*t}this.modules.sprite.update(t)}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.translate(this.state.pos[0],this.state.pos[1]),this.modules.sprite.render(t),t.restore()}}]),t}());e["default"]=r},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=n(a),l=function(){function t(e){i(this,t),this.externals=e,this.state={},this.modules={},this.state.pos=[0,0],this.state.speed=this.externals.state.isMobile?280:200,this.state.defence=!1,this.modules.sprite=new r["default"](this.externals.modules.spritesUrl,[5,160],[70,60],16,[0,1,2,3,4,3,2,1]),this.modules.defence=new r["default"](this.externals.modules.spritesUrl,[0,500],[130,100],14,[0,1,2,1])}return s(t,[{key:"checkBounds",value:function(){var t=this.state.pos,e=this.modules.sprite,o=this.externals.modules.canvas;t[0]<0?t[0]=0:t[0]>o.width-e.size[0]&&(t[0]=o.width-e.size[0]),t[1]<0?t[1]=0:t[1]>o.height-e.size[1]&&(t[1]=o.height-e.size[1])}},{key:"update",value:function(){this.modules.sprite.update(this.externals.state.dt),this.state.defence&&this.modules.defence.update(this.externals.state.dt)}},{key:"render",value:function(){var t=this.externals.modules.ctx;if(t.save(),t.translate(this.state.pos[0],this.state.pos[1]),this.state.defence){var e=(this.modules.sprite.size[0]-this.modules.defence.size[0])/2,o=(this.modules.sprite.size[1]-this.modules.defence.size[1])/2;t.translate(e,o),this.modules.defence.render(t),t.translate(-e,-o)}this.modules.sprite.render(t),t.restore()}}]),t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=n(a),l=function(){function t(e,o,n,s){i(this,t),this.externals=e,this.state={},this.modules={},this.state.speed=o||80,this.state.pos=[this.externals.modules.canvas.width,Math.random()*(this.externals.modules.canvas.height-39)],this.state.hp=n||1,this.state.score=n||1,this.modules.sprite=s||new r["default"](this.externals.modules.spritesUrl,[0,230],[70,60],6,[0,1,2,3,2,1])}return s(t,[{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"update",value:function(){var t=this.externals.state.dt;this.state.pos[0]-=this.state.speed*t,this.modules.sprite.update(t)}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.translate(this.state.pos[0],this.state.pos[1]),this.modules.sprite.render(t),t.restore()}}]),t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(9),r=(n(a),o(10)),l=(n(r),o(11)),c=(n(l),function(){function t(e){i(this,t),this.externals=e}return s(t,[{key:"collides",value:function(t,e,o,n,i,s,a,r){return!(o<=i||t>a||n<=s||e>r)}},{key:"boxCollides",value:function(t,e,o,n){return this.collides(t[0],t[1],t[0]+e[0],t[1]+e[1],o[0],o[1],o[0]+n[0],o[1]+n[1])}},{key:"check",value:function(){var t=this;this.externals.state.player.checkBounds();for(var e=this.externals.state.enemies,o=this.externals.state.bullets,n=this.externals.state.gifts,i=this.externals.state.player,s=function(n){for(var s=e[n].state.pos,r=e[n].modules.sprite.size,l=0;l<o.length;l++){var c=o[l].state.pos,u=o[l].modules.sprite.size;if(t.boxCollides(s,r,c,u)){var d=Math.min(e[n].state.hp,o[l].state.power);if(e[n].state.hp-=d,o[l].state.power-=d,0==e[n].state.hp){var h=e[n].state.score;t.externals.state.isGameOver||(t.externals.state.score+=t.externals.state.scoreMultiply*h),e.splice(n,1),n--,t.externals.state.giftsLen<4&&Math.random()<.1+h/50&&!function(){t.externals.state.giftsLen++;var e=[0,1,1,0,0,2,0,3,0,1,2],o=~~(e.length*Math.random());window.setTimeout(function(){console.log(o,e[o]);var t=this.externals.modules.objects.gifts[e[o]](this.externals,[s[0]-50,s[1]]);console.log(t),this.externals.state.gifts.push(t)}.bind(t),1e3)}()}t.externals.state.explosions.push(t.externals.modules.objects.explosions.regular(t.externals,s)),0==o[l].state.power&&o.splice(l,1);break}}t.externals.state.isGameOver||i.state.defence||!t.boxCollides(s,r,i.state.pos,i.modules.sprite.size)||t.externals.modules.gameOver(),a=n},a=0;a<e.length;a++)s(a);for(var r=0;r<n.length;){var l=n[r].state.pos,c=n[r].modules.sprite.size;if(this.boxCollides(l,c,i.state.pos,i.modules.sprite.size)){this.externals.state.giftsLen--;var u=this.externals.state.powerups.push(n[r].modules.gift.type,n[r].modules.gift.name);u.isNew&&!this.externals.state.powerups.isAnyOfTypeActive(n[r].modules.gift.type)&&u.powerup.activate(),n.splice(r,1),this.externals.state.score+=3}else r++}}}]),t}());e["default"]=c},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=n(a),l=function(){function t(e,o){i(this,t),this.externals=e,this.state={},this.modules={},this.state.pos=o,this.modules.sprite=new r["default"](this.externals.modules.spritesUrl,[0,117],[39,39],16,[0,1,2,3,4,5,6,7,8,9,10,11,12],null,(!0))}return s(t,[{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"update",value:function(){this.modules.sprite.update(this.externals.state.dt)}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.translate(this.state.pos[0],this.state.pos[1]),this.modules.sprite.render(t),t.restore()}}]),t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=n(a),l=function(){function t(e,o,n,s,a,l){i(this,t),this.externals=e,this.state={},this.state.pos=a,this.state.expirationTime=s,this.state.scale=1,this.state.rotate=0,this.state.rotateSpeed=10,this.modules={},this.modules.sprite=l||new r["default"](this.externals.modules.spritesUrl,[0,350],[50,50],5,[0,1]),this.modules.gift={type:o,name:n}}return s(t,[{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"update",value:function(){this.modules.sprite.update(this.externals.state.dt)}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.translate(this.state.pos[0],this.state.pos[1]),this.modules.sprite.render(t),t.restore()}}]),t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(3),r=n(a),l=function(){function t(e,o,n,s){switch(i(this,t),this.externals=e,this.state={type:o,name:n,durationTime:s,active:!1},this.modules={},o){case"bullets":this.modules.sprite=e.modules.objects[o][n](e,[0,0]).modules.sprite,this.state.durationTime=s||~~(20*Math.random()+5);break;case"special":"lsd"===n&&(this.modules.sprite=new r["default"](e.modules.spritesUrl,[50,30],[20,20]),this.state.durationTime=s||~~(5*Math.random()+5));break;case"defence":"regular"===this.state.name&&(this.modules.sprite=new r["default"](e.modules.spritesUrl,[71,621],[9,9]),this.state.durationTime=s||~~(15*Math.random()+5))}this.state.width=this.modules.sprite.size[0]+50,this.state.height=Math.max(this.modules.sprite.size[1],30)}return s(t,[{key:"addTouchToogle",value:function(){this.externals.modules.controls.addTouchArea(this.state.type+"_"+this.state.name,-this.state.width,-this.state.height,this.state.width,this.state.height,void 0,void 0,function(){(this.state.active?this.deactivate.bind(this):this.activate.bind(this))()}.bind(this))}},{key:"activate",value:function(){switch(this.externals.state.powerups.deactivateAllOfType(this.state.type),this.state.type){case"bullets":this.externals.state.weapon.set(this.state.name,this.state.durationTime+this.externals.state.gameTime);break;case"special":if("lsd"===this.state.name){this.externals.state.scoreMultiply=3;var t=o(12);this.externals.state.bgImg=new Image(this.externals.modules.canvas.width,this.externals.modules.canvas.height),this.externals.state.bgImg.src=t}break;case"defence":"regular"===this.state.name&&(this.externals.state.player.state.defence=!0)}this.state.active=!0}},{key:"deactivate",value:function(){switch(this.state.type){case"bullets":this.externals.state.weapon.restoreDefault();break;case"special":"lsd"===this.state.name&&(this.externals.state.bgImg=null,this.externals.state.scoreMultiply=1);break;case"defence":"regular"===this.state.name&&(this.externals.state.player.state.defence=!1)}this.state.active=!1}},{key:"update",value:function(t){this.state.active&&(this.state.durationTime-=this.externals.state.dt),this.state.x=this.externals.modules.canvas.width-(t+this.state.width);var e=this.externals.modules.controls,o=e.indexOf(this.state.type+"_"+this.state.name);return e.state.touchAreas[o].x=this.state.x,e.state.touchAreas[o].y=10,this.state.width+20}},{key:"render",value:function(t){var e=this.externals.modules.ctx,o=this.modules.sprite,n=o.size[0],i=o.size[1],s=this.state.x;e.save(),e.font="16px sans-serif",e.fillStyle="rgba(255,255,255,0.1)",e.translate(s,10),e.save(),e.strokeStyle=this.state.active?"#31864f":"#4f586f",e.lineWidth=this.externals.state.isMobile?1:3,e.strokeRect(0,0,n+50,Math.max(i,30)),e.fillStyle="rgba(61,68,86,0.1)";var a=void 0;return e.fillRect(1,1,n+50-2,a=Math.max(i,30)-2),e.translate(1,(a-i)/2),o.render(e),e.restore(),e.fillStyle="#fffafa",e.translate(n+15,20),e.fillText(~~this.state.durationTime,0,0),e.restore(),n+70}}]),t}();e["default"]=l},function(t,e,o){t.exports=o.p+"img/plasma.jpg"},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e,n,i,s,a,r){o(this,t),this.externals=e,this.state={top:0,left:0,speed:50},this.modules={img:n,rangeX:s,rangeY:a,scale:i,screenW:this.externals.modules.canvas.width,screenH:this.externals.modules.canvas.height,direction:r?-1:1}}return n(t,[{key:"update",value:function(){var t=this.externals.state.dt;this.state.left-=this.state.speed*t,-this.state.left>this.modules.rangeX&&(this.state.left=0)}},{key:"render",value:function(){var t=this.externals.modules.ctx,e=this.externals.modules.canvas;t.save(),t.scale(this.modules.scale,this.modules.scale),t.translate(this.state.left,0),t.fillStyle=t.createPattern(this.modules.img,"repeat"),t.fillRect(0,0,e.width+this.modules.rangeX,e.height),t.restore()}}]),t}();e["default"]=i},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e,n){o(this,t),this.externals=e;var i=Math.floor(3*Math.random());
this.state={color:"#fffafa",_speed:[30,40,50][i],speed:[30,40,50][i],yRange:[30,50,70][i],x:n||e.modules.canvas.width+10,y:Math.random()*e.modules.canvas.height,radius:[1,2,2.5][i]},this.modules={}}return n(t,[{key:"getInternals",value:function(){return{state:this.state,modules:this.modules}}},{key:"changeSpeed",value:function(t){this.state.speed+=t}},{key:"restoreSpeed",value:function(){this.state.speed=this.state._speed}},{key:"movefromLeftToRight",value:function(){this.state.x=this.externals.modules.canvas.width+10,this.state.y=Math.random()*this.externals.modules.canvas.height}},{key:"update",value:function(){var t=this.externals.state.dt;this.state.x-=this.state.speed*t,this.state.x<0&&this.movefromLeftToRight()}},{key:"render",value:function(){var t=this.externals.modules.ctx,e=this.externals.modules.canvas,o=this.state.y+(this.externals.state.player.state.pos[1]-.5*e.height)/e.height*this.state.yRange;t.save(),t.fillStyle=this.state.color,t.beginPath(),t.arc(this.state.x,o,this.state.radius,0,2*Math.PI),t.fill(),t.restore()}}]),t}();e["default"]=i},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(6),s=n(i),a=o(7),r=n(a),l=o(3),c=n(l),u=o(5),d=n(u),h=o(9),f=n(h),p=o(10),v=n(p);e["default"]={enemies:{regular:function(t){return new r["default"](t)},johnHardson:function(t){return new r["default"](t,50,5,new c["default"](t.modules.spritesUrl,[0,78],[80,39],6,[0,1,2,3,2,1]))}},bullets:{regular_forward:function(t,e){return new d["default"](t,e,"forward",1,500,new c["default"](t.modules.spritesUrl,[0,39],[18,8]))},torpedo_forward:function(t,e){return new d["default"](t,e,"forward",3,400,new c["default"](t.modules.spritesUrl,[10,290],[10,10]))},plasma_forward:function(t,e){return new d["default"](t,e,"forward",5,350,new c["default"](t.modules.spritesUrl,[20,30],[30,20]))}},player:function(){return new s["default"](this.getInternals())},powerups:{},gifts:[function(t,e){return new v["default"](t,"bullets","torpedo_forward",t.state.gameTime+20*Math.random()+5,e)},function(t,e){return new v["default"](t,"bullets","plasma_forward",t.state.gameTime+20*Math.random()+5,e,new c["default"](t.modules.spritesUrl,[0,400],[50,50],5,[0,1]))},function(t,e){return new v["default"](t,"special","lsd",t.state.gameTime+15*Math.random()+10,e,new c["default"](t.modules.spritesUrl,[0,450],[50,50],5,[0,1]))},function(t,e){return new v["default"](t,"defence","regular",t.state.gameTime+15*Math.random()+10,e,new c["default"](t.modules.spritesUrl,[0,600],[50,50],5,[0,1]))}],explosions:{regular:function(t,e){return new f["default"](t,e)}}}},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(){o(this,t),this["default"]="regular_forward",this.restoreDefault()}return n(t,[{key:"restoreDefault",value:function(){this.current=this["default"],this.deltaLimit=100}},{key:"set",value:function(t,e){switch(this.current=t,t){case"regular_forward":this.deltaLimit=100;break;case"torpedo_forward":this.deltaLimit=130;break;case"plasma_forward":this.deltaLimit=160}}}]),t}();e["default"]=i},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(11),r=n(a),l=function(){function t(e){i(this,t),this.externals=e,this.state=[],this.modules={}}return s(t,[{key:"deactivateAllOfType",value:function(t){for(var e=this.state.length;--e>=0;)this.state[e].state.type==t&&this.state[e].deactivate()}},{key:"activateOneOfType",value:function(t){for(var e=this.state.length;--e>=0&&this.state[e].state.type!=t;);e>=0&&this.state[e].activate()}},{key:"isAnyActive",value:function(){for(var t=this.state.length;--t>=0&&!this.state[t].state.active;);return t>-1}},{key:"isAnyOfTypeActive",value:function(t){for(var e=this.state.length;--e>=0&&(this.state[e].state.type!=t||!this.state[e].state.active););return e>-1}},{key:"_contains",value:function(t){for(var e=this.state.length;--e>=0&&this.state[e].state.name!=t;);return e}},{key:"push",value:function(t,e){var o=void 0,n=!1;return(o=this._contains(e))<0?(o=this.state.length,this.state.push(new r["default"](this.externals,t,e)),this.state[o].addTouchToogle(),n=!0):this.state[o].state.durationTime+=new r["default"](this.externals,t,e).state.durationTime,{powerup:this.state[o],isNew:n}}},{key:"resetTouchAreas",value:function(){var t=this;this.state.forEach(function(e){t.externals.modules.controls.removeTouchArea(e.state.type+"_"+e.state.name)})}},{key:"update",value:function(){for(var t=this.state,e=100,o=0;o<t.length;)if(e+=t[o].update(e),t[o].state.durationTime<=0){t[o].deactivate();var n=t[o].state.type;this.externals.modules.controls.removeTouchArea(n+"_"+t[o].state.name),t.splice(o,1),this.activateOneOfType(n)}else o++}},{key:"render",value:function(){var t=100;this.state.forEach(function(e){t+=e.render(t)})}}]),t}();e["default"]=l},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e,n){o(this,t),this.externals=e,this.state={active:"none",screens:n},Object.keys(n).forEach(function(t,e){n[t].classList.add("hide")}),this.modules={}}return n(t,[{key:"set",value:function(t){"none"!=this.state.active&&this.state.screens[this.state.active].classList.add("hide"),"none"!=t&&this.state.screens[t].classList.remove("hide"),this.state.active=t}}]),t}();e["default"]=i},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(20),r=n(a),l=o(21),c=n(l),u=o(22),d=n(u),h=function(){function t(e){i(this,t),this.externals=e,this.state={active:void 0,views:{menu:new r["default"](this.externals),gameOver:new c["default"](this.externals),gameplay:new d["default"](this.externals)}}}return s(t,[{key:"set",value:function(t){this.unset(),this.state.views.hasOwnProperty(t)&&(this.state.active=t,this.state.views[this.state.active].activate())}},{key:"unset",value:function(){this.state.active&&(this.state.views[this.state.active].deactivate(),this.state.active=void 0)}},{key:"update",value:function(){this.state.active&&this.state.views[this.state.active].update()}},{key:"renderButton",value:function(t,e,o,n,i,s,a){var r=this.externals.modules.ctx;r.save(),r.save();var l=Math.max(e,r.measureText(n).width),c=t/2;r.strokeStyle=i,r.fillStyle=s,r.beginPath(),r.arc(c,c,c,.5*Math.PI,1.5*Math.PI),r.lineTo(c+l+o,0),r.translate(c+l+o,0),r.arc(0,c,c,1.5*Math.PI,.5*Math.PI),r.lineTo(-(c+l+o)+c,t),r.fill(),r.stroke(),r.restore(),r.fillStyle=a,r.textAlign="center",r.textBaseline="middle",r.fillText(n,(2*c+o+l)/2,t/2),r.restore()}},{key:"render",value:function(){this.state.active&&this.state.views[this.state.active].render()}}]),t}();e["default"]=h},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e){o(this,t),this.externals=e;var n=20,i=100,s=100,a=20,r=this.externals.modules.canvas;this.state={startPos:[r.width/2-(2*n+i+s)/2,(r.height-8*n-3*a)/2],btnRad:n,btnWidth:i,btnOffset:s,btnMargin:a},this.modules={}}return n(t,[{key:"activate",value:function(){var t=this.externals.modules.controls,e=2*this.state.btnRad+this.state.btnWidth+this.state.btnOffset,o=2*this.state.btnRad+this.state.btnMargin;t.addTouchArea("play",this.state.startPos[0],this.state.startPos[1],e,2*this.state.btnRad,function(){this.externals.modules.reset(!1)}.bind(this),void 0,function(){this.externals.modules.views.set("gameplay")}.bind(this)),t.addTouchArea("settings",this.state.startPos[0],this.state.startPos[1]+o,e,2*this.state.btnRad,void 0,void 0,function(){alert("We are working on it")}.bind(this)),t.addTouchArea("credits",this.state.startPos[0],this.state.startPos[1]+2*o,e,2*this.state.btnRad,void 0,void 0,function(){alert("We are working on it")}.bind(this)),t.addTouchArea("exit",this.state.startPos[0],this.state.startPos[1]+3*o,e,2*this.state.btnRad,void 0,void 0,function(){console.log(window.cordova),navigator.isCocoonJS?window.Cocoon.App.exit():window.history.back()}.bind(this))}},{key:"deactivate",value:function(){var t=this.externals.modules.controls;t.removeTouchArea("play"),t.removeTouchArea("settings"),t.removeTouchArea("credits"),t.removeTouchArea("exit")}},{key:"update",value:function(){}},{key:"render",value:function(){var t=this.externals.modules.ctx;t.save(),t.lineWidth=1,t.font="18px sans-serif";var e=this.state.btnRad,o=this.state.btnWidth,n=this.state.btnOffset,i=this.state.btnMargin;t.translate(this.state.startPos[0],this.state.startPos[1]),this.externals.modules.views.renderButton(2*e,o,n,"Play","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.translate(0,i+2*e),this.externals.modules.views.renderButton(2*e,o,n,"Settings","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.translate(0,i+2*e),this.externals.modules.views.renderButton(2*e,o,n,"Credits","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.translate(0,i+2*e),this.externals.modules.views.renderButton(2*e,o,n,"Exit","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.restore()}}]),t}();e["default"]=i},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e){o(this,t),this.externals=e;var n=20,i=100,s=100,a=20,r=30;this.state={btnRad:n,btnWidth:i,btnOffset:s,btnMargin:a,fontSize:r},this.modules={}}return n(t,[{key:"activate",value:function(){var t=this.externals.modules.controls,e=2*this.state.btnRad+this.state.btnWidth+this.state.btnOffset,o=2*this.state.btnRad+this.state.btnMargin,n=2*this.state.fontSize+3*this.state.btnMargin+2*(2*this.state.btnRad),i=2*this.state.fontSize+2*this.state.btnMargin,s=(this.externals.modules.canvas.height-n)/2+i,a=(this.externals.modules.canvas.width-e)/2;console.log(s,a,e),t.addTouchArea("play-again",a,s,e,2*this.state.btnRad,function(){this.externals.modules.reset(!1)}.bind(this),void 0,function(){this.externals.modules.views.set("gameplay")}.bind(this)),t.addTouchArea("menu",a,s+o,e,2*this.state.btnRad,function(){this.externals.modules.reset(!0)}.bind(this),void 0,function(){this.externals.modules.views.set("menu")}.bind(this))}},{key:"deactivate",value:function(){var t=this.externals.modules.controls;t.removeTouchArea("play-again"),t.removeTouchArea("menu");var e=localStorage.getItem("highscore");(!e||e<this.externals.state.score)&&localStorage.setItem("highscore",this.externals.state.score)}},{key:"update",value:function(){}},{key:"render",value:function(){var t=this.externals.modules.ctx,e=this.externals.state.score,o=this.externals.state.highscore,n=this.state.btnRad,i=this.state.btnWidth,s=this.state.btnOffset,a=this.state.btnMargin,r=this.state.fontSize,l=Math.max(t.measureText("Your Score : "+e).width,t.measureText("New High Score!").width,t.measureText("High Score : "+o).width),c=2*r+3*a+2*(2*n),u=[(t.canvas.width-l)/2,(t.canvas.height-c)/2];t.save(),t.lineWidth=1,t.fillStyle="#fffafa",t.font=r+"px sans-serif",t.textAlign="center",t.textBaseline="middle",t.translate(u[0],u[1]),t.fillText("Your Score : "+e,l/2,r/2),t.translate(0,r+a),e>o&&(t.fillStyle="#f2d749"),t.fillText(e>o?"New High Score!":"High Score : "+o,l/2,r/2),t.setTransform(1,0,0,1,0,0),t.translate(t.canvas.width/2-(2*n+i+s)/2,2*r+2*a+u[1]),t.font="18px sans-serif",this.externals.modules.views.renderButton(2*n,i,s,"Play again","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.translate(0,a+2*n),this.externals.modules.views.renderButton(2*n,i,s,"Menu","#fffafa","rgba(255,255,255,0.1)","#fffafa"),t.restore()}}]),t}();e["default"]=i},function(t,e){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=function(){function t(e){o(this,t),this.externals=e;var n=30,i=30,s=20,a=20,r=100,l=100,c=20,u=this.externals.modules.canvas;this.state={playHeight:n,playWidth:i,playMargin:s,startPos:[u.width/2-(2*a+r+l)/2,(u.height-4*a-c)/2],btnRad:a,btnWidth:r,btnOffset:l,btnMargin:c},this.modules={}}return n(t,[{key:"activate",value:function(){var t=this.externals.modules.controls;t.addTouchArea("pause",this.state.playMargin,this.state.playMargin,this.state.playWidth,this.state.playHeight,void 0,void 0,function(){if(this.externals.modules.tooglePause()){var e=2*this.state.btnRad+this.state.btnWidth+this.state.btnOffset,o=2*this.state.btnRad+this.state.btnMargin;t.addTouchArea("resume",this.state.startPos[0],this.state.startPos[1],e,2*this.state.btnRad,void 0,void 0,function(){this.externals.modules.tooglePause(),t.removeTouchArea("resume"),t.removeTouchArea("menu")}.bind(this)),t.addTouchArea("menu",this.state.startPos[0],this.state.startPos[1]+o,e,2*this.state.btnRad,void 0,void 0,function(){this.externals.modules.reset(!0),this.externals.modules.tooglePause(),this.externals.modules.views.set("menu")}.bind(this))}else t.removeTouchArea("resume"),t.removeTouchArea("menu")}.bind(this))}},{key:"deactivate",value:function(){var t=this.externals.modules.controls;t.removeTouchArea("pause"),t.removeTouchArea("resume"),t.removeTouchArea("menu")}},{key:"update",value:function(){}},{key:"render",value:function(){var t=this.externals.modules.ctx,e=this.state.playHeight,o=this.state.playWidth,n=this.state.playMargin;if(t.save(),t.lineWidth=1,t.fillStyle="#fffafa",t.strokeStyle="#fffafa",this.externals.state.stop){t.beginPath(),t.moveTo(n,n),t.lineTo(o+n,n+e/2),t.lineTo(n,n+e),t.closePath(),t.fill(),t.font="18px sans-serif";var i="#fffafa",s="rgba(255,255,255,0.1)",a=this.state.btnRad,r=this.state.btnWidth,l=this.state.btnOffset,c=this.state.btnMargin;t.translate(this.state.startPos[0],this.state.startPos[1]),this.externals.modules.views.renderButton(2*a,r,l,"Resume",i,s,i),t.translate(0,c+2*a),this.externals.modules.views.renderButton(2*a,r,l,"Menu",i,s,i)}else t.beginPath(),t.rect(n,n,o/3,e),t.rect(n+o/3*2,n,o/3,e),t.fill();t.restore()}}]),t}();e["default"]=i},function(t,e,o){var n=o(24);"string"==typeof n&&(n=[[t.id,n,""]]);o(26)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,o){e=t.exports=o(25)(),e.push([t.id,"body,html{margin:0;padding:0;overflow:hidden;-webkit-user-select:none}canvas{display:block;margin:auto;position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;z-index:2}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var o=this[e];o[2]?t.push("@media "+o[2]+"{"+o[1]+"}"):t.push(o[1])}return t.join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var s=this[i][0];"number"==typeof s&&(n[s]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&n[a[0]]||(o&&!a[2]?a[2]=o:o&&(a[2]="("+a[2]+") and ("+o+")"),t.push(a))}},t}},function(t,e,o){function n(t,e){for(var o=0;o<t.length;o++){var n=t[o],i=f[n.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](n.parts[s]);for(;s<n.parts.length;s++)i.parts.push(c(n.parts[s],e))}else{for(var a=[],s=0;s<n.parts.length;s++)a.push(c(n.parts[s],e));f[n.id]={id:n.id,refs:1,parts:a}}}}function i(t){for(var e=[],o={},n=0;n<t.length;n++){var i=t[n],s=i[0],a=i[1],r=i[2],l=i[3],c={css:a,media:r,sourceMap:l};o[s]?o[s].parts.push(c):e.push(o[s]={id:s,parts:[c]})}return e}function s(t,e){var o=y(),n=b[b.length-1];if("top"===t.insertAt)n?n.nextSibling?o.insertBefore(e,n.nextSibling):o.appendChild(e):o.insertBefore(e,o.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");o.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function r(t){var e=document.createElement("style");return e.type="text/css",s(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",s(t,e),e}function c(t,e){var o,n,i;if(e.singleton){var s=w++;o=m||(m=r(e)),n=u.bind(null,o,s,!1),i=u.bind(null,o,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=l(e),n=h.bind(null,o),i=function(){a(o),o.href&&URL.revokeObjectURL(o.href)}):(o=r(e),n=d.bind(null,o),i=function(){a(o)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}function u(t,e,o,n){var i=o?"":n.css;if(t.styleSheet)t.styleSheet.cssText=x(e,i);else{var s=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function d(t,e){var o=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}function h(t,e){var o=e.css,n=e.sourceMap;n&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([o],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}var f={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),y=p(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,w=0,b=[];t.exports=function(t,e){if("object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var o=i(t);return n(o,e),function(t){for(var s=[],a=0;a<o.length;a++){var r=o[a],l=f[r.id];l.refs--,s.push(l)}if(t){var c=i(t);n(c,e)}for(var a=0;a<s.length;a++){var l=s[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete f[l.id]}}}};var x=function(){var t=[];return function(e,o){return t[e]=o,t.filter(Boolean).join("\n")}}()},function(t,e,o){t.exports=o.p+"img/sprites.png"},function(t,e,o){t.exports=o.p+"music/Unknown_Planet_cutted.ogg"},function(t,e){"use strict";!function(){var e=window.Cocoon||(window.Cocoon={});window.cordova&&"undefined"!=typeof t&&(t.exports=e),e.version="1.0",e.extend=function(t,e){var o=t.prototype,n=function(){};n.prototype=e.prototype,t.prototype=new n,t.superclass=e.prototype,t.prototype.constructor=t,e.prototype.constructor===Object.prototype.constructor&&(e.prototype.constructor=e);for(var i in o)o.hasOwnProperty(i)&&(t.prototype[i]=o[i])},e.exec=function(t,e,o,n,i){window.cordova?window.cordova.exec(n,i,t,e,o):console.error("window.cordova not found")},e.define=function(e,o,n){for(var i="Cocoon."==e.substring(0,7)?e.substr(7):e,s=window.Cocoon,a=i.split("."),r=s,l=0;l<a.length;l++){var c=a[l];if(r[c]?console.log("Updated namespace: - "+e):console.log("Created namespace: "+e),r=r[c]=l==a.length-1?o(r[c]||{}):{},!r)throw"Unable to create class "+e}return arguments.length<2&&(n=!0),n&&"undefined"!=typeof t&&(t.exports=r),!0},e.Signal=function(){this.signals={}},e.Signal.prototype={on:function(t,e){if(!t||!e)throw new Error("Can't create signal "+(t||""));var o=this.signals[t];o||(o=[],this.signals[t]=o),o.push(e)},emit:function(t,e,o){var n=this.signals[t];if(n)for(var i=0;i<n.length;++i){var s=n[i];e&&(s=s[e]),s&&s.apply(null,o||[])}},remove:function(t,e){var o=this.signals[t];if(o)if(e)for(var n=0;n<o.lenght;++n)o[n]===e&&(o.splice(n,1),--n);else o.lenght=0},expose:function(){return this.on.bind(this)}},e.PlatformType={ANDROID:"android",IOS:"ios",AMAZON:"amazon",WINDOWS_PHONE:"wp",BLACKBERRY:"blackberry",OTHER:"other"};var o;e.getPlatform=function(){if(o)return o;var t=navigator.userAgent;return o=navigator.isCocoonJS?/ios/gi.test(t)?e.PlatformType.IOS:e.PlatformType.ANDROID:/(iPad|iPhone|iPod)/g.test(t)?e.PlatformType.IOS:/Kindle/i.test(t)||/Silk/i.test(t)||/KFTT/i.test(t)||/KFOT/i.test(t)||/KFJWA/i.test(t)||/KFJWI/i.test(t)||/KFSOWI/i.test(t)||/KFTHWA/i.test(t)||/KFTHWI/i.test(t)||/KFAPWA/i.test(t)||/KFAPWI/i.test(t)?e.PlatformType.AMAZON:/Android/i.test(t)?e.PlatformType.ANDROID:/BlackBerry/i.test(navigator.userAgent)?e.PlatformType.BLACKBERRY:/IEMobile/i.test(navigator.userAgent)?e.PlatformType.WINDOWS_PHONE:e.PlatformType.OTHER},console.log("Created namespace: Cocoon")}()},function(t,e){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(){var t=window.Cocoon;t.nativeAvailable=!!window.ext,t.clone=function(t,e){if(null===t||"object"!==("undefined"==typeof t?"undefined":o(t)))return t;var n=[];for(var i in t)e.hasOwnProperty(i)?n.push(e[i]):n.push(t[i]);return n},t.callNative=function(e,o,n,i){if(t.nativeAvailable){var s=Array.prototype.slice.call(n);s.unshift(o);var a=ext[e],r=i?a.makeCallAsync:a.makeCall,l=r.apply(a,s),c=l;if("string"==typeof l)try{c=JSON.parse(l)}catch(u){console.log(u)}return c}},t.getObjectFromPath=function(t,e){for(var o=e.split("."),n=t,i=0,s=o.length;i<s;++i)n[o[i]]=n[o[i]]||void 0,n=n[o[i]];return n},t.EventHandler=function(e,o,n,i){return this.listeners=[],this.listenersOnce=[],this.chainFunction=i,this.addEventListener=function(s){if(i){var a=function(){i.call(this,arguments.callee.sourceListener,Array.prototype.slice.call(arguments))};s.CocoonEventHandlerChainFunction=a,a.sourceListener=s,s=a}var r=t.getObjectFromPath(t,o);if(r&&r.nativeAvailable)ext[e].addEventListener(n,s);else{var l=this.listeners.indexOf(s);l<0&&this.listeners.push(s)}},this.addEventListenerOnce=function(s){if(i){var a=function(){i(arguments.callee.sourceListener,Array.prototype.slice.call(arguments))};a.sourceListener=s,s=a}var r=t.getObjectFromPath(t,o);if(r.nativeAvailable)ext[e].addEventListenerOnce(n,s);else{var l=this.listeners.indexOf(s);l<0&&this.listenersOnce.push(s)}},this.removeEventListener=function(s){i&&(s=s.CocoonEventHandlerChainFunction,delete s.CocoonEventHandlerChainFunction);var a=t.getObjectFromPath(t,o);if(a.nativeAvailable)ext[e].removeEventListener(n,s);else{var r=this.listeners.indexOf(s);r>=0&&this.listeners.splice(r,1)}},this.removeEventListenerOnce=function(s){i&&(s=s.CocoonEventHandlerChainFunction,delete s.CocoonEventHandlerChainFunction);var a=t.getObjectFromPath(t,o);if(a.nativeAvailable)ext[e].removeEventListenerOnce(n,s);else{var r=this.listenersOnce.indexOf(s);r>=0&&this.listenersOnce.splice(r,1)}},this.notifyEventListeners=function(){var i=t.getObjectFromPath(t,o);if(i&&i.nativeAvailable)ext[e].notifyEventListeners(n);else{var s=Array.prototype.slice.call(arguments),a=Array.prototype.slice.call(this.listeners),r=Array.prototype.slice.call(this.listenersOnce),l=this;setTimeout(function(){for(var t=0;t<a.length;t++)a[t].apply(l,s);for(t=0;t<r.length;t++)r[t].apply(l,s)},0),l.listenersOnce=[]}},this},t.createSignal=function(){this.handle=null,this.signals={},this.register=function(t,e){if(!t&&!e)throw new Error("Can't create signal "+(t||""));if(e.addEventListener)return this.signals[t]=e,!0;if(!e.addEventListener){this.signals[t]={};for(var o in e)e.hasOwnProperty(o)&&(this.signals[t][o]=e[o]);return!0}throw new Error("Can't create handler for "+t+" signal.")},this.expose=function(){return function(t,e,o){var n=!1;if(1===arguments.length){var i=this,s=function(t){this.signal=t};return s.prototype.remove=function(t){var e=i.signals[this.signal];e&&e.removeEventListener&&(e.removeEventListener.apply(i,[t]),i.signals[this.signal]=void 0)},new s(t)}if(o&&o.once&&(n=!0),!this.signals[t])throw new Error("The signal "+t+" does not exists.");var a=this.signals[t];if(a.addEventListener&&(n?a.addEventListenerOnce(function(){e.apply(this||window,arguments)}):a.addEventListener(function(){e.apply(this||window,arguments)})),!this.signals[t].addEventListener)for(var r in this.signals[t])this.signals[t].hasOwnProperty(r)&&(a=this.signals[t][r],n?a.addEventListenerOnce(function(){this.clbk[this.name].apply(this||window,arguments)}.bind({name:r,clbk:e})):a.addEventListener(function(){this.clbk[this.name].apply(this||window,arguments)}.bind({name:r,clbk:e})))}.bind(this)}},window.CocoonJS=window.Cocoon,window.c2cocoonjs=!0}(),Cocoon.define("Cocoon.App",function(t){t.nativeAvailable=!!window.ext&&!!window.ext.IDTK_APP,t.isBridgeAvailable=function(){if("boolean"===Cocoon.App.forward.nativeAvailable)return Cocoon.App.forward.nativeAvailable;var t=Cocoon.callNative("IDTK_APP","forwardAvailable",arguments);return t=!!t,Cocoon.App.forward.nativeAvailable=t,t};var e="CocoonJS_App_ForCocoonJS_WebViewIFrame";t.forward=function(t){return Cocoon.App.nativeAvailable&&Cocoon.App.isBridgeAvailable()?Cocoon.callNative("IDTK_APP","forward",arguments):navigator.isCocoonJS?void 0:window.name===e?window.parent.eval(t):window.frames[e].window.eval(t)},t.forwardAsync=function(t,o){return Cocoon.App.nativeAvailable&&Cocoon.App.isBridgeAvailable()?"undefined"!=typeof o?ext.IDTK_APP.makeCallAsync("forward",t,o):ext.IDTK_APP.makeCallAsync("forward",t):void setTimeout(function(){var n;n=window.name===e?window.parent.eval(t):window.parent.frames[e].window.eval(t),o&&o(n)},1)},t.load=function(t,e){if(Cocoon.App.nativeAvailable)return Cocoon.callNative("IDTK_APP","loadPath",arguments);if(!navigator.isCocoonJS){var o=new XMLHttpRequest;o.onreadystatechange=function(e){if(4===o.readyState){var n;200===o.status?(n=Cocoon.App.EmulatedWebViewIFrame?"window.Cocoon && window.Cocoon.App.onLoadInCocoonJSSucceed.notifyEventListeners('"+t+"');":"window.Cocoon && window.Cocoon.App.onLoadInTheWebViewSucceed.notifyEventListeners('"+t+"');",Cocoon.App.forwardAsync(n),window.location.href=t):404===o.status&&(this.onreadystatechange=null,n=Cocoon.App.EmulatedWebViewIFrame?"Cocoon && Cocoon.App.onLoadInCocoonJSFailed.notifyEventListeners('"+t+"');":"Cocoon && Cocoon.App.onLoadInTheWebViewFailed.notifyEventListeners('"+t+"');",Cocoon.App.forwardAsync(n))}},o.open("GET",t,!0),o.send()}},t.reload=function(){return Cocoon.App.nativeAvailable?Cocoon.callNative("IDTK_APP","reload",arguments):navigator.isCocoonJS?void 0:window.name===e?window.parent.location.reload():window.parent.frames[e].window.location.reload()},t.openURL=function(t){return Cocoon.App.nativeAvailable?Cocoon.callNative("IDTK_APP","openURL",arguments,!0):void(navigator.isCocoonJS||window.open(t,"_blank"))},t.exit=function(){return Cocoon.App.nativeAvailable?Cocoon.callNative("IDTK_APP","forceToFinish",arguments):void(navigator.isCocoonJS||window.close())},t.StorageType={APP_STORAGE:"APP_STORAGE",INTERNAL_STORAGE:"INTERNAL_STORAGE",EXTERNAL_STORAGE:"EXTERNAL_STORAGE",TEMPORARY_STORAGE:"TEMPORARY_STORAGE"},t.onSuspended=new Cocoon.EventHandler("IDTK_APP","App","onsuspended"),t.onActivated=new Cocoon.EventHandler("IDTK_APP","App","onactivated"),t.onSuspending=new Cocoon.EventHandler("IDTK_APP","App","onsuspending"),t.onMemoryWarning=new Cocoon.EventHandler("IDTK_APP","App","onmemorywarning");var o=new Cocoon.createSignal;return o.register("suspended",t.onSuspended),o.register("activated",t.onActivated),o.register("suspending",t.onSuspending),o.register("memorywarning",t.onMemoryWarning),t.on=o.expose(),t}),window.Box2D&&window.Box2D.HEAP32?console.log("The CocoonJS binding for Box2D has been ignored because Box2D Emscripten have been found"):window.Box2D?console.log("The CocoonJS binding for Box2D has been ignored another Box2D have been found"):window.ext&&"undefined"!=typeof window.ext.IDTK_SRV_BOX2D?(window.Box2D={},window.CocoonBox2D=window.Box2D,window.Box2D.Dynamics={},window.Box2D.Dynamics.Joints={},window.Box2D.Common={},window.Box2D.Common.Math={},window.Box2D.Collision={},window.Box2D.Collision.Shapes={},function(){function t(t){console.error(t)}var e=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e};window.Box2D.Common.Math.b2Vec2=e,e.prototype.SetZero=function(){this.x=0,this.y=0},e.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},e.prototype.SetV=function(e){void 0===e&&t("undefined 'v' in b2Vec2.SetV"),this.x=e.x,this.y=e.y},e.Make=function(t,o){return void 0===t&&(t=0),void 0===o&&(o=0),new e(t,o)},void 0===e.Get&&(e.Get=e.Make,e._freeCache=[],e.Free=function(){}),e.prototype.Copy=function(){return new e(this.x,this.y)},e.prototype.Add=function(e){void 0===e&&t("undefined 'v' in b2Vec2.Add"),this.x+=e.x,this.y+=e.y},e.prototype.Subtract=function(e){void 0===e&&t("undefined 'v' in b2Vec2.Subtract"),this.x-=e.x,this.y-=e.y},e.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},e.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},e.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y};var o=function(){this.col1=new e,this.col2=new e,this.SetIdentity()};window.Box2D.Common.Math.b2Mat22=o,o.FromAngle=function(t){void 0===t&&(t=0);var e=new o;return e.Set(t),e},o.FromVV=function(t,e){var n=new o;return n.SetVV(t,e),n},o.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),o=Math.sin(t);this.col1.x=e,this.col2.x=-o,this.col1.y=o,this.col2.y=e},o.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},o.prototype.Copy=function(){var t=new o;return t.SetM(this),t},o.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},o.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},o.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},o.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},o.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},o.prototype.GetInverse=function(t){var e=this.col1.x,o=this.col2.x,n=this.col1.y,i=this.col2.y,s=e*i-o*n;
return 0!==s&&(s=1/s),t.col1.x=s*i,t.col2.x=-s*o,t.col1.y=-s*n,t.col2.y=s*e,t},o.prototype.Solve=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var n=this.col1.x,i=this.col2.x,s=this.col1.y,a=this.col2.y,r=n*a-i*s;return 0!==r&&(r=1/r),t.x=r*(a*e-i*o),t.y=r*(n*o-s*e),t},o.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()};var n=function(t,n){this.position=new e,this.R=new o,void 0===t&&(t=null),void 0===n&&(n=null),t&&(this.position.SetV(t),this.R.SetM(n))};window.Box2D.Common.Math.b2Transform=n,n.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},n.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},n.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},n.prototype.SetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};var i=function(){};window.Box2D.Common.Math.b2Math=i,i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,o){void 0===o&&(o=0);var n=new e(o*t.y,-o*t.x);return n},i.CrossFV=function(t,o){void 0===t&&(t=0);var n=new e(-t*o.y,t*o.x);return n},i.MulMV=function(o,n){void 0===n&&t("undefined 'v' in b2Math.MulMV");var i=new e(o.col1.x*n.x+o.col2.x*n.y,o.col1.y*n.x+o.col2.y*n.y);return i},i.MulTMV=function(t,o){var n=new e(i.Dot(o,t.col1),i.Dot(o,t.col2));return n},i.MulX=function(t,e){var o=i.MulMV(t.R,e);return o.x+=t.position.x,o.y+=t.position.y,o},i.MulXT=function(t,e){var o=i.SubtractVV(e,t.position),n=o.x*t.R.col1.x+o.y*t.R.col1.y;return o.y=o.x*t.R.col2.x+o.y*t.R.col2.y,o.x=n,o},i.AddVV=function(t,o){var n=new e(t.x+o.x,t.y+o.y);return n},i.SubtractVV=function(t,o){var n=new e(t.x-o.x,t.y-o.y);return n},i.Distance=function(t,e){var o=t.x-e.x,n=t.y-e.y;return Math.sqrt(o*o+n*n)},i.DistanceSquared=function(t,e){var o=t.x-e.x,n=t.y-e.y;return o*o+n*n},i.MulFV=function(t,o){void 0===t&&(t=0);var n=new e(t*o.x,t*o.y);return n},i.AddMM=function(t,e){var n=o.FromVV(i.AddVV(t.col1,e.col1),i.AddVV(t.col2,e.col2));return n},i.MulMM=function(t,e){var n=o.FromVV(i.MulMV(t,e.col1),i.MulMV(t,e.col2));return n},i.MulTMM=function(t,n){var s=new e(i.Dot(t.col1,n.col1),i.Dot(t.col2,n.col1)),a=new e(i.Dot(t.col1,n.col2),i.Dot(t.col2,n.col2)),r=o.FromVV(s,a);return r},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){var o=new e(i.Abs(t.x),i.Abs(t.y));return o},i.AbsM=function(t){var e=o.FromVV(i.AbsV(t.col1),i.AbsV(t.col2));return e},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,o){var n=new e(i.Min(t.x,o.x),i.Min(t.y,o.y));return n},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,o){var n=new e(i.Max(t.x,o.x),i.Max(t.y,o.y));return n},i.Clamp=function(t,e,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),t<e?e:t>o?o:t},i.ClampV=function(t,e,o){return i.MaxV(e,i.MinV(t,o))},i.Swap=function(t,e){var o=t[0];t[0]=e[0],e[0]=o},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=Math.random();return o=(e-t)*o+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,t|=t>>16&65535,t+1},i.IsPowerOfTwo=function(t){void 0===t&&(t=0);var e=t>0&&0===(t&t-1);return e},i.b2Vec2_zero=new e(0,0),i.b2Mat22_identity=o.FromVV(new e(1,0),new e(0,1)),i.b2Transform_identity=new n(i.b2Vec2_zero,i.b2Mat22_identity);var s=function(){this.e_aabbBit=4,this.e_centerOfMassBit=16,this.e_controllerBit=32,this.e_jointBit=2,this.e_pairBit=8,this.e_shapeBit=0};window.Box2D.Dynamics.b2DebugDraw=s,s.prototype.AppendFlags=function(){},s.prototype.ClearFlags=function(){},s.prototype.DrawCircle=function(){},s.prototype.DrawPolygon=function(){},s.prototype.DrawSegment=function(){},s.prototype.DrawSolidCircle=function(){},s.prototype.DrawSolidPolygon=function(){},s.prototype.DrawTransform=function(){},s.prototype.GetAlpha=function(){},s.prototype.GetDrawScale=function(){},s.prototype.GetFillAlpha=function(){},s.prototype.GetFlags=function(){},s.prototype.GetLineThickness=function(){},s.prototype.GetSprite=function(){},s.prototype.GetXFormScale=function(){},s.prototype.SetAlpha=function(){},s.prototype.SetDrawScale=function(){},s.prototype.SetFillAlpha=function(){},s.prototype.SetFlags=function(){},s.prototype.SetLineThickness=function(){},s.prototype.SetSprite=function(){},s.prototype.SetXFormScale=function(){};var a=function(){this.position=new e(0,0),this.linearVelocity=new e,this.userData=null,this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=l.b2_staticBody,this.active=!0,this.inertiaScale=1};window.Box2D.Dynamics.b2BodyDef=a;var r=function(t,o,n,i){this.m_body=t,this.m_userData=o,this.m_fixtureID=n,this.m_shape={},this.m_shape.m_centroid=new e,this.m_isSensor=!1,this.m_density=i.density,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_isSensor=i.isSensor};window.Box2D.Dynamics.b2Fixture=r,r.prototype.GetBody=function(){return this.m_body},r.prototype.GetShape=function(){return console.log("fixture.GetShape not yet supported in CocoonJS Box2D binding"),null},r.prototype.GetUserData=function(){return this.m_userData},r.prototype.SetSensor=function(t){this.m_isSensor=t,window.ext.IDTK_SRV_BOX2D.makeCall("setSensor",this.m_body.m_world.m_worldID,this.m_fixtureID,this.m_isSensor)},r.prototype.IsSensor=function(){return this.m_isSensor},r.prototype.SetDensity=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setDensity",this.m_body.m_world.m_worldID,this.m_fixtureID,t),this.m_density=t},r.prototype.SetFriction=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setFriction",this.m_body.m_world.m_worldID,this.m_fixtureID,t),this.m_friction=t},r.prototype.SetRestitution=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setRestitution",this.m_body.m_world.m_worldID,this.m_fixtureID,t),this.m_restitution=t},r.prototype.GetDensity=function(){return this.m_density},r.prototype.GetFriction=function(){return this.m_friction},r.prototype.GetRestitution=function(){return this.m_restitution};var l=function m(t,e){var i=t.userData;t.userData=null,this.m_world=e,this.m_xf=new n(t.position,o.FromAngle(t.angle)),this.m_fixtures=[],this.m_active=t.active,t.type===m.b2_staticBody&&(t.density=0),this.m_bodyID=window.ext.IDTK_SRV_BOX2D.makeCall("createBody",e.m_worldID,t),this.m_userData=i,t.userData=i};window.Box2D.Dynamics.b2Body=l,l.prototype.CreateFixture=function(t){var e=t.userData;t.userData=null;var o=window.ext.IDTK_SRV_BOX2D.makeCall("createFixture",this.m_world.m_worldID,this.m_bodyID,t);t.userData=e;var n=new r(this,e,o,t);return this.m_world.m_fixturesList[o]=n,this.m_fixtures.push(n),n},l.prototype.GetFixtureList=function(){return 0===this.m_fixtures.length?null:this.m_fixtures[0]},l.prototype.DestroyFixture=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("deleteFixture",this.m_world.m_worldID,t.m_fixtureID),delete this.m_world.m_fixturesList[t.m_fixtureID]},l.prototype.SetPositionAndAngle=function(t,e){window.ext.IDTK_SRV_BOX2D.makeCall("setBodyTransform",this.m_world.m_worldID,this.m_bodyID,t.x,t.y,e),this.m_xf.R.Set(e),this.m_xf.position.SetV(t)},l.prototype.GetPosition=function(){return this.m_xf.position},l.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},l.prototype.GetLinearVelocity=function(){var t=window.ext.IDTK_SRV_BOX2D.makeCall("getLinearVelocity",this.m_world.m_worldID,this.m_bodyID);return new e(t[0],t[1])},l.prototype.GetWorldCenter=function(){var t=window.ext.IDTK_SRV_BOX2D.makeCall("getWorldCenter",this.m_world.m_worldID,this.m_bodyID);return new e(t[0],t[1])},l.prototype.GetLocalCenter=function(){var t=window.ext.IDTK_SRV_BOX2D.makeCall("getLocalCenter",this.m_world.m_worldID,this.m_bodyID);return new e(t[0],t[1])},l.prototype.GetLocalPoint=function(t){return i.MulXT(this.m_xf,t)},l.prototype.ApplyImpulse=function(t,e,o){window.ext.IDTK_SRV_BOX2D.makeCall("applyImpulse",this.m_world.m_worldID,this.m_bodyID,t.x,t.y,e.x,e.y,o)},l.prototype.GetMass=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("getMass",this.m_world.m_worldID,this.m_bodyID)},l.prototype.IsAwake=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("isAwake",this.m_world.m_worldID,this.m_bodyID)},l.prototype.GetAngularVelocity=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("getAngularVelocity",this.m_world.m_worldID,this.m_bodyID)},l.prototype.SetFixedRotation=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setFixedRotation",this.m_world.m_worldID,this.m_bodyID,t)},l.prototype.SetAwake=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setAwake",this.m_world.m_worldID,this.m_bodyID,t)},l.prototype.SetLinearVelocity=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setLinearVelocity",this.m_world.m_worldID,this.m_bodyID,t.x,t.y)},l.prototype.ApplyForceToCenter=function(t,e){window.ext.IDTK_SRV_BOX2D.makeCall("applyForceToCenter",this.m_world.m_worldID,this.m_bodyID,t.x,t.y,e)},l.prototype.ApplyForce=function(t,e,o){window.ext.IDTK_SRV_BOX2D.makeCall("applyForce",this.m_world.m_worldID,this.m_bodyID,t.x,t.y,e.x,e.y,o)},l.prototype.ApplyTorque=function(t,e){window.ext.IDTK_SRV_BOX2D.makeCall("applyTorque",this.m_world.m_worldID,this.m_bodyID,t,e)},l.prototype.SetLinearDamping=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setLinearDamping",this.m_world.m_worldID,this.m_bodyID,t)},l.prototype.SetAngularVelocity=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setAngularVelocity",this.m_world.m_worldID,this.m_bodyID,t)},l.prototype.SetType=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setType",this.m_world.m_worldID,this.m_bodyID,t)},l.prototype.SetActive=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setActive",this.m_world.m_worldID,this.m_bodyID,t),this.m_active=t},l.prototype.IsActive=function(){return this.m_active},l.prototype.GetAngle=function(){return this.m_xf.R.GetAngle()},l.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},l.prototype.GetContactList=function(){for(var t=window.ext.IDTK_SRV_BOX2D.makeCall("getObjectContacts",this.m_world.m_worldID,this.m_bodyID),e=[],o=0;o<t.length;o++)e.push(this.m_world.m_bodyList[t[o]]);return e},l.prototype.SetUserData=function(t){this.m_userData=t},l.prototype.GetUserData=function(){return this.m_userData},l.prototype.GetWorld=function(){return this.m_world},window.Box2D.Dynamics.b2Body.b2_staticBody=0,window.Box2D.Dynamics.b2Body.b2_kinematicBody=1,window.Box2D.Dynamics.b2Body.b2_dynamicBody=2;var c=function(t,e,o){this.m_fixtureA=t,this.m_fixtureB=e,this.m_touching=o};window.Box2D.Dynamics.b2Contact=c,c.prototype.GetFixtureA=function(){return this.m_fixtureA},c.prototype.GetFixtureB=function(){return this.m_fixtureB},c.prototype.IsTouching=function(){return this.m_touching};var u=function(){};window.Box2D.Dynamics.b2ContactListener=u,u.prototype.BeginContact=function(){},u.prototype.EndContact=function(){},u.prototype.PreSolve=function(){},u.prototype.PostSolve=function(){},window.Box2D.Dynamics.b2ContactListener.b2_defaultListener=new u;var d=function(){};window.Box2D.Dynamics.b2ContactFilter=d;var h=function(t,e){this.m_bodyList=[],this.m_jointList=[],this.m_fixturesList=[],this.m_contactListener=null,this.m_jointsList=[],this.m_worldID=window.ext.IDTK_SRV_BOX2D.makeCall("createWorld",t.x,t.y,e)};window.Box2D.Dynamics.b2World=h,h.prototype.SetContactListener=function(t){this.m_contactListener=t},h.prototype.SetContactFilter=function(t){var e=t,o=this,n=function(t,n){var i=o.m_fixturesList[t],s=o.m_fixturesList[n];return e.ShouldCollide(i,s)};window.ext.IDTK_SRV_BOX2D.makeCall("setContactFilter",this.m_worldID,n)},h.prototype.CreateBody=function(t){var e=new l(t,this);return this.m_bodyList[e.m_bodyID]=e,e},h.prototype.DestroyBody=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("deleteBody",this.m_worldID,t.m_bodyID),delete this.m_bodyList[t.m_bodyID];for(var e=0;e<t.m_fixtures.length;++e)delete this.m_fixturesList[t.m_fixtures[e].m_fixtureID]},h.prototype.CreateJoint=function(t){if(t.bodyA.m_bodyID!==t.bodyB.m_bodyID){var e=t.bodyA,o=t.bodyB;t.bodyA=e.m_bodyID,t.bodyB=o.m_bodyID;var n="createDistanceJoint";t.type===p.e_revoluteJoint&&(n="createRevoluteJoint");var i=new p(t);return i.m_jointID=window.ext.IDTK_SRV_BOX2D.makeCall(n,this.m_worldID,t),t.bodyA=e,t.bodyB=o,this.m_jointsList.push(i),i}},h.prototype.DestroyJoint=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("destroyJoint",this.m_worldID,t.m_jointID)},h.prototype.GetJointList=function(){if(0===this.m_jointsList.length)return null;for(var t=0;t<this.m_jointsList.length-1;++t)this.m_jointsList[t].next=this.m_jointsList[t+1];return this.m_jointsList[this.m_jointsList.length-1].next=null,this.m_jointsList[0]},h.prototype.SetContinuousPhysics=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setContinuous",this.m_worldID,t)},h.prototype.SetGravity=function(t){window.ext.IDTK_SRV_BOX2D.makeCall("setGravity",this.m_worldID,t.x,t.y)},h.prototype.Step=function(t,e,o){var n,i=window.ext.IDTK_SRV_BOX2D.makeCall("step",this.m_worldID,t,e,o),s=i[0];for(n=1;n<=4*s;n+=4){var a=this.m_bodyList[i[n+0]];if(null===a)break;a.m_xf.position.Set(i[n+1],i[n+2]),a.m_xf.R.Set(i[n+3])}if(null!==this.m_contactListener){var r=window.ext.IDTK_SRV_BOX2D.makeCall("getLastContacts",this.m_worldID);for(s=r[0],n=1;n<=3*s;n+=3){var l=r[n+0],u=r[n+1],d=r[n+2],h=this.m_fixturesList[l],f=this.m_fixturesList[u];"undefined"!=typeof h&&"undefined"!=typeof f?this.m_contactListener.BeginContact(new c(h,f,d)):console.log("One of the fixtures in a contact DOESN'T EXIST!!")}}},h.prototype.ClearForces=function(){window.ext.IDTK_SRV_BOX2D.makeCall("clearForces",this.m_worldID)},h.prototype.SetDebugDraw=function(){},h.prototype.DrawDebugData=function(){},window.Box2D.Collision.Shapes.b2CircleShape=function(t){this.radius=t,this.type="circle"},window.Box2D.Collision.Shapes.b2PolygonShape=function(){this.SetAsBox=function(t,e){this.type="box",this.width=t,this.height=e},this.SetAsEdge=function(t,e){this.type="edge",this.p1x=t.x,this.p1y=t.y,this.p2x=e.x,this.p2y=e.y},this.SetAsArray=function(t,e){this.type="polygon",this.vertices=[];for(var o=0;o<e;o++)this.vertices.push(t[o].x),this.vertices.push(t[o].y)}};var f=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter={categoryBits:1,maskBits:65535,groupIndex:0}};window.Box2D.Dynamics.b2FixtureDef=f;var p=function(t){this.bodyA=t.bodyA,this.bodyB=t.bodyB,this.userData=t.userData,this.type=t.type,this.next=null};window.Box2D.Dynamics.Joints.b2Joint=p,p.prototype.GetBodyA=function(){return this.bodyA},p.prototype.GetBodyB=function(){return this.bodyB},p.prototype.GetUserData=function(){return this.userData},p.prototype.GetType=function(){return this.type},p.prototype.GetNext=function(){return this.next},p.e_distanceJoint=0,p.e_revoluteJoint=1;var v=function(t,o,n,i){if(this.type=p.e_distanceJoint,this.localAnchorA=new e,this.localAnchorB=new e,this.userData=null,void 0!==t&&(this.bodyA=t),void 0!==o&&(this.bodyB=o),void 0!==n&&this.localAnchorA.SetV(n),void 0!==i&&this.localAnchorB.SetV(i),void 0!==n&&void 0!==i){var s=i.x-n.x,a=i.y-n.y;this.length=Math.sqrt(s*s+a*a)}this.frequencyHz=0,this.dampingRatio=0};window.Box2D.Dynamics.Joints.b2DistanceJointDef=v;var y=function(t,o,n,i){this.type=p.e_revoluteJoint,this.localAnchorA=new e,this.localAnchorB=new e,this.userData=null,void 0!==t&&(this.bodyA=t),void 0!==o&&(this.bodyB=o),void 0!==n&&this.localAnchorA.SetV(n),void 0!==i&&this.localAnchorB.SetV(i),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1};y.prototype.Initialize=function(t,e,o){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(o),this.localAnchorB=this.bodyB.GetLocalPoint(o),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},window.Box2D.Dynamics.Joints.b2RevoluteJointDef=y}()):console.log("The CocoonJS binding for Box2D has been ignored because ext.IDTK_SRV_BOX2D is not available"),Cocoon.define("Cocoon.Device",function(t){return t.DeviceInfo={os:null,version:null,dpi:null,brand:null,model:null,imei:null,platformId:null,odin:null,openudid:null},t.getDeviceId=function(){if(Cocoon.nativeAvailable)return window.ext.IDTK_APP.makeCall("getDeviceId")},t.getDeviceInfo=function(){if(Cocoon.nativeAvailable)return window.ext.IDTK_APP.makeCall("getDeviceInfo")},t.getOrientation=function(){return Cocoon.nativeAvailable?window.ext.IDTK_APP.makeCall("getPreferredOrientation"):0},t.setOrientation=function(t){Cocoon.nativeAvailable&&window.ext.IDTK_APP.makeCall("setPreferredOrientation",t)},t.Orientations={PORTRAIT:1,PORTRAIT_UPSIDE_DOWN:2,LANDSCAPE_LEFT:4,LANDSCAPE_RIGHT:8,LANDSCAPE:12,BOTH:15},t.autoLock=function(t){if(Cocoon.nativeAvailable)return Cocoon.callNative("IDTK_APP","setAutoLockEnabled",arguments)},t}),Cocoon.define("Cocoon.Dialog",function(t){return t.keyboardType={TEXT:"text",NUMBER:"num",PHONE:"phone",EMAIL:"email",URL:"url"},t.prompt=function(t,e){if(!e)throw"Callback missing for Cocoon.Dialog.prompt();";var o=Cocoon.Dialog.keyboardType.TEXT;switch(t.type){case Cocoon.Dialog.keyboardType.TEXT:o=Cocoon.Dialog.keyboardType.TEXT;break;case Cocoon.Dialog.keyboardType.NUMBER:o=Cocoon.Dialog.keyboardType.NUMBER;break;case Cocoon.Dialog.keyboardType.PHONE:o=Cocoon.Dialog.keyboardType.PHONE;break;case Cocoon.Dialog.keyboardType.EMAIL:o=Cocoon.Dialog.keyboardType.EMAIL;break;case Cocoon.Dialog.keyboardType.URL:o=Cocoon.Dialog.keyboardType.URL}var n={title:"",message:"",text:"",type:o,cancelText:"Cancel",confirmText:"Ok",secureText:!1},i=Cocoon.clone(n,t),s=function r(){Cocoon.Dialog.onTextDialogCancelled.removeEventListener(a),Cocoon.Dialog.onTextDialogFinished.removeEventListener(r),e.success.apply(window,Array.prototype.slice.call(arguments))},a=function l(){Cocoon.Dialog.onTextDialogCancelled.removeEventListener(l),Cocoon.Dialog.onTextDialogFinished.removeEventListener(s),e.cancel.apply(window,Array.prototype.slice.call(arguments))};return Cocoon.Dialog.onTextDialogCancelled.addEventListener(a),Cocoon.Dialog.onTextDialogFinished.addEventListener(s),Cocoon.App.nativeAvailable?Cocoon.callNative("IDTK_APP","showTextDialog",i,!0):void setTimeout(function(){var t=prompt(n.message,n.text),e=t?Cocoon.Dialog.onTextDialogFinished:Cocoon.Dialog.onTextDialogCancelled;e.notifyEventListeners(t)},0)},t.confirm=function(t,e){if(!e)throw"Callback missing for Cocoon.Dialog.confirm();";var o={title:"",message:"",cancelText:"Cancel",confirmText:"Ok"},n=Cocoon.clone(o,t),i=function(){Cocoon.Dialog.onMessageBoxDenied.removeEventListenerOnce(s),e(!0)},s=function(){Cocoon.Dialog.onMessageBoxConfirmed.removeEventListenerOnce(i),e(!1)};return Cocoon.Dialog.onMessageBoxDenied.addEventListenerOnce(s),Cocoon.Dialog.onMessageBoxConfirmed.addEventListenerOnce(i),Cocoon.nativeAvailable?Cocoon.callNative("IDTK_APP","showMessageBox",n,!0):void setTimeout(function(){var t=confirm(o.message),e=t?Cocoon.Dialog.onMessageBoxConfirmed:Cocoon.Dialog.onMessageBoxDenied;e.notifyEventListeners()},0)},t.showKeyboard=function(t,e){t=t||{},t.type=t.type||Cocoon.Dialog.keyboardType.TEXT;var o=e&&e.insertText,n=e&&e.deleteBackward,i=e&&e.done,s=e&&e.cancel;Cocoon.nativeAvailable&&Cocoon.callNative("IDTK_APP","showKeyboard",[t,o,n,i,s],!0)},t.dismissKeyboard=function(){Cocoon.nativeAvailable&&Cocoon.callNative("IDTK_APP","dismissKeyboard",[],!0)},t.onTextDialogFinished=new Cocoon.EventHandler("IDTK_APP","App","ontextdialogfinish"),t.onTextDialogCancelled=new Cocoon.EventHandler("IDTK_APP","App","ontextdialogcancel"),t.onMessageBoxConfirmed=new Cocoon.EventHandler("IDTK_APP","App","onmessageboxconfirmed"),t.onMessageBoxDenied=new Cocoon.EventHandler("IDTK_APP","App","onmessageboxdenied"),t}),Cocoon.define("Cocoon.Motion",function(t){return t.nativeAvailable=Cocoon.nativeAvailable,t.setAccelerometerInterval=function(t){if(Cocoon.Motion.nativeAvailable)return window.ext.IDTK_APP.makeCall("setAccelerometerUpdateIntervalInSeconds",t)},t.getAccelerometerInterval=function(){if(Cocoon.Motion.nativeAvailable)return window.ext.IDTK_APP.makeCall("getAccelerometerUpdateIntervalInSeconds")},t.setGyroscopeInterval=function(t){if(Cocoon.Motion.nativeAvailable)return window.ext.IDTK_APP.makeCall("setGyroscopeUpdateIntervalInSeconds",t)},t.getGyroscopeInterval=function(){Cocoon.Motion.nativeAvailable&&window.ext.IDTK_APP.makeCall("getGyroscopeUpdateIntervalInSeconds")},t}),Cocoon.define("Cocoon.App",function(t){function e(){var t=Cocoon.App.EmulatedWebView;if(!t){t=document.createElement("div"),t.setAttribute("id","CocoonJS_App_ForCocoonJS_WebViewDiv"),t.style.width=0,t.style.height=0,t.style.position="absolute",t.style.left=0,t.style.top=0,t.style.backgroundColor="transparent",t.style.border="0px solid #000";var e=document.createElement("IFRAME");e.setAttribute("id","CocoonJS_App_ForCocoonJS_WebViewIFrame"),e.setAttribute("name","CocoonJS_App_ForCocoonJS_WebViewIFrame"),e.style.width=0,e.style.height=0,e.frameBorder=0,e.allowtransparency=!0,t.appendChild(e),Cocoon.App.EmulatedWebView=t,Cocoon.App.EmulatedWebViewIFrame=e,document.body||(document.body=document.createElement("body")),document.body.appendChild(Cocoon.App.EmulatedWebView)}}t.pause=function(){if(Cocoon.App.nativeAvailable)return Cocoon.callNative("IDTK_APP","pause",arguments)},t.resume=function(){if(Cocoon.App.nativeAvailable)return Cocoon.callNative("IDTK_APP","resume",arguments)},t.loadInTheWebView=function(t,o){if(navigator.isCocoonJS&&Cocoon.App.nativeAvailable)Cocoon.callNative("IDTK_APP","loadInTheWebView",arguments);else{var n=new XMLHttpRequest;n.onreadystatechange=function(o){if(4===n.readyState)if(n.status>=200&&n.status<=299||0===n.status){e();var i=function s(e){Cocoon.App.onLoadInTheWebViewSucceed.notifyEventListeners(t),Cocoon.App.EmulatedWebViewIFrame.removeEventListener("load",s)};Cocoon.App.EmulatedWebViewIFrame.addEventListener("load",i),Cocoon.App.EmulatedWebViewIFrame.contentWindow.location.href=t}else this.onreadystatechange=null,Cocoon.App.onLoadInTheWebViewFailed.notifyEventListeners(t)},n.open("GET",t,!0),n.send()}},t.reloadWebView=function(){Cocoon.App.nativeAvailable&&navigator.isCocoonJS?Cocoon.callNative("IDTK_APP","reloadWebView",arguments):(e(),Cocoon.App.EmulatedWebViewIFrame.contentWindow.location.reload())},t.showTheWebView=function(t,o,n,i){Cocoon.App.nativeAvailable&&navigator.isCocoonJS?Cocoon.callNative("IDTK_APP","showTheWebView",arguments):(e(),Cocoon.App.EmulatedWebViewIFrame.style.width=(n?n/window.devicePixelRatio:window.innerWidth)+"px",Cocoon.App.EmulatedWebViewIFrame.style.height=(i?i/window.devicePixelRatio:window.innerHeight)+"px",Cocoon.App.EmulatedWebView.style.left=(t?t:0)+"px",Cocoon.App.EmulatedWebView.style.top=(o?o:0)+"px",Cocoon.App.EmulatedWebView.style.width=(n?n/window.devicePixelRatio:window.innerWidth)+"px",Cocoon.App.EmulatedWebView.style.height=(i?i/window.devicePixelRatio:window.innerHeight)+"px",Cocoon.App.EmulatedWebView.style.display="block")},t.hideTheWebView=function(){if(Cocoon.App.nativeAvailable&&navigator.isCocoonJS){var t="ext.IDTK_APP.makeCall('hide');";return Cocoon.App.forwardAsync(t)}e(),Cocoon.App.EmulatedWebView.style.display="none"},t.forwardedEventFromTheWebView=function(t,e){var o=JSON.parse(e);o.target=window;var n=new Event(t);for(var i in o)n[i]=o[i];n.target=window,window.dispatchEvent(n);for(var s=document.getElementsByTagName("canvas"),a=0;a<s.length;a++)n.target=s[a],s[a].dispatchEvent(n)},t.onLoadInTheWebViewSucceed=new Cocoon.EventHandler("IDTK_APP","App","forwardpageload"),t.onLoadInTheWebViewFailed=new Cocoon.EventHandler("IDTK_APP","App","forwardpagefail");var o=new Cocoon.createSignal;return o.register("load",{success:t.onLoadInTheWebViewSucceed,error:t.onLoadInTheWebViewFailed}),t.WebView=Cocoon.WebView||{},t.WebView.on=o.expose(),t}),Cocoon.define("Cocoon.Proxify",function(t){return t.getKeyForValueInDictionary=function(t,e){var o=null;for(var n in t)if(t[n]===e){o=n;break}return o},t.setupOriginProxyType=function(e,o,n,i){if(Cocoon.nativeAvailable){if(!e)throw"The given typeName must be valid.";if(!o&&!n&&!i)throw"There is no point on setting up a proxy for no attributes, functions nor eventHandlers.";o=o?o:[],n=n?n:[],i=i?i:[];var s=window,a="Cocoon.Proxify.setupDestinationProxyType("+JSON.stringify(e)+", "+JSON.stringify(i)+");";Cocoon.App.forward(a);var r=s[e];s[e]=function(){var t=this;this._cocoonjs_proxy_object_data={};var a="Cocoon.Proxify.newDestinationProxyObject("+JSON.stringify(e)+");";this._cocoonjs_proxy_object_data.id=Cocoon.App.forward(a),this._cocoonjs_proxy_object_data.eventHandlers={},this._cocoonjs_proxy_object_data.typeName=e,this._cocoonjs_proxy_object_data.eventListeners={},s[e]._cocoonjs_proxy_type_data.proxyObjects[this._cocoonjs_proxy_object_data.id]=this;for(var r=0;r<o.length;r++)!function(o){t.__defineSetter__(o,function(n){var i="Cocoon.Proxify.setDestinationProxyObjectAttribute("+JSON.stringify(e)+", "+t._cocoonjs_proxy_object_data.id+", "+JSON.stringify(o)+", "+JSON.stringify(n)+");";return Cocoon.App.forward(i)}),t.__defineGetter__(o,function(){var n="Cocoon.Proxify.getDestinationProxyObjectAttribute("+JSON.stringify(e)+", "+t._cocoonjs_proxy_object_data.id+", "+JSON.stringify(o)+");";return Cocoon.App.forward(n)})}(o[r]);for(r=0;r<n.length;r++)!function(o){t[o]=function(){var t=Array.prototype.slice.call(arguments);t.unshift(o),t.unshift(this._cocoonjs_proxy_object_data.id),t.unshift(e);for(var n="Cocoon.Proxify.callDestinationProxyObjectFunction(",i=0;i<t.length;i++)n+=(1!==i?JSON.stringify(t[i]):t[i])+(i<t.length-1?", ":"");n+=");";var s=Cocoon.App.forwardAsync(n);return s}}(n[r]);for(r=0;r<i.length;r++)!function(e){t.__defineSetter__(e,function(o){t._cocoonjs_proxy_object_data.eventHandlers[e]=o}),t.__defineGetter__(e,function(){return t._cocoonjs_proxy_object_data.eventHandlers[e]})}(i[r]);return t.addEventListener=function(e,o){var n=!0,i=t._cocoonjs_proxy_object_data.eventListeners[e];if(i)n=i.indexOf(o)<0;else{i=[],t._cocoonjs_proxy_object_data.eventListeners[e]=i;var s="Cocoon.Proxify.addDestinationProxyObjectEventListener("+JSON.stringify(t._cocoonjs_proxy_object_data.typeName)+", "+t._cocoonjs_proxy_object_data.id+", "+JSON.stringify(e)+");";Cocoon.App.forwardAsync(s)}n&&i.push(o)},t.removeEventListener=function(e,o){var n=t._cocoonjs_proxy_object_data.eventListeners[e];if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}},this},s[e]._cocoonjs_proxy_type_data={originalType:r,proxyObjects:[]},s[e]._cocoonjs_proxy_type_data.deleteProxyObject=function(o){var n=t.getKeyForValueInDictionary(this.proxyObjects,o);if(n){var i="Cocoon.Proxify.deleteDestinationProxyObject("+JSON.stringify(e)+", "+o._cocoonjs_proxy_object_data.id+");";Cocoon.App.forwardAsync(i),o._cocoonjs_proxy_object_data=null,delete this.proxyObjects[n]}},s[e]._cocoonjs_proxy_type_data.callProxyObjectEventHandler=function(t,e){var o=this.proxyObjects[t],n=o._cocoonjs_proxy_object_data.eventHandlers[e];n&&n({target:o})},s[e]._cocoonjs_proxy_type_data.callProxyObjectEventListeners=function(t,e){for(var o=this.proxyObjects[t],n=o._cocoonjs_proxy_object_data.eventListeners[e].slice(),i=0;i<n.length;i++)n[i]({target:o})}}},t.takedownOriginProxyType=function(t){if(Cocoon.App.nativeAvailable){var e=window;e[t]&&e[t]._cocoonjs_proxy_type_data&&(e[t]=e[t]._cocoonjs_proxy_type_data.originalType)}},t.deleteOriginProxyObject=function(t){if(Cocoon.App.nativeAvailable){var e=window;t&&t._cocoonjs_proxy_object_data&&e[t._cocoonjs_proxy_object_data.typeName]._cocoonjs_proxy_type_data.deleteProxyObject(t)}},t.callOriginProxyObjectEventHandler=function(t,e,o){if(Cocoon.App.nativeAvailable){var n=window;n[t]._cocoonjs_proxy_type_data.callProxyObjectEventHandler(e,o)}},t.callOriginProxyObjectEventListeners=function(t,e,o){if(Cocoon.App.nativeAvailable){var n=window;n[t]._cocoonjs_proxy_type_data.callProxyObjectEventListeners(e,o)}},t.setupDestinationProxyType=function(t,e){if(Cocoon.App.nativeAvailable){var o=window;o[t]._cocoonjs_proxy_type_data={nextId:0,proxyObjects:{},eventHandlerNames:e}}},t.takedownDestinationProxyType=function(t){if(Cocoon.App.nativeAvailable){var e=window;parent[t]&&e[t]._cocoonjs_proxy_type_data&&delete e[t]._cocoonjs_proxy_type_data}},t.newDestinationProxyObject=function(t){if(Cocoon.App.nativeAvailable){var e=window,o=new e[t];o._cocoonjs_proxy_object_data={},o._cocoonjs_proxy_object_data.typeName=t;var n=e[t]._cocoonjs_proxy_type_data.nextId;e[t]._cocoonjs_proxy_type_data.proxyObjects[n]=o,o._cocoonjs_proxy_object_data.id=n,e[t]._cocoonjs_proxy_type_data.nextId++;for(var i=0;i<e[t]._cocoonjs_proxy_type_data.eventHandlerNames.length;i++)!function(t){o[t]=function(e){var o=this,n="Cocoon.App.callOriginProxyObjectEventHandler("+JSON.stringify(o._cocoonjs_proxy_object_data.typeName)+", "+o._cocoonjs_proxy_object_data.id+", "+JSON.stringify(t)+");";Cocoon.App.forwardAsync(n)}}(e[t]._cocoonjs_proxy_type_data.eventHandlerNames[i]);return o._cocoonjs_proxy_object_data.eventListeners={},n}},t.callDestinationProxyObjectFunction=function(t,e,o){if(Cocoon.App.nativeAvailable){var n=window,i=Array.prototype.slice.call(arguments);i.splice(0,3);var s=n[t]._cocoonjs_proxy_type_data.proxyObjects[e],a=s[o].apply(s,i);return a}},t.setDestinationProxyObjectAttribute=function(t,e,o,n){if(Cocoon.App.nativeAvailable){var i=window,s=i[t]._cocoonjs_proxy_type_data.proxyObjects[e];s[o]=n}},t.getDestinationProxyObjectAttribute=function(t,e,o){if(Cocoon.App.nativeAvailable){var n=window,i=n[t]._cocoonjs_proxy_type_data.proxyObjects[e];return i[o]}},t.deleteDestinationProxyObject=function(t,e){if(Cocoon.App.nativeAvailable){var o=window;delete o[t]._cocoonjs_proxy_type_data.proxyObjects[e]}},t.addDestinationProxyObjectEventListener=function(t,e,o){if(Cocoon.App.nativeAvailable){var n=window,i=n[t]._cocoonjs_proxy_type_data.proxyObjects[e],s=function(t){var e=this,n="Cocoon.Proxify.callOriginProxyObjectEventListeners("+JSON.stringify(e._cocoonjs_proxy_object_data.typeName)+", "+e._cocoonjs_proxy_object_data.id+", "+JSON.stringify(o)+");";Cocoon.App.forwardAsync(n)};i._cocoonjs_proxy_object_data.eventListeners[o]=s,i.addEventListener(o,s)}},t.xhr=function(){var t=["timeout","withCredentials","upload","status","statusText","responseType","response","responseText","responseXML","readyState"],e=["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","overrideMimeType"],o=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"];Cocoon.Proxify.setupOriginProxyType("XMLHttpRequest",t,e,o)},t.audio=function(){var t=["src","loop","volume","preload"],e=["play","pause","load","canPlayType"],o=["onended","oncanplay","oncanplaythrough","onerror"];Cocoon.Proxify.setupOriginProxyType("Audio",t,e,o)},t.console=function(){if(Cocoon.nativeAvailable){"undefined"==typeof Cocoon.originalConsole&&(Cocoon.originalConsole=window.console);for(var t=["log","error","info","debug","warn"],e={},o=0;o<t.length;o++)e[t[o]]=function(t){return function(t){try{var e="Proxified log: "+JSON.stringify(t);Cocoon.originalConsole.log(e),ext.IDTK_APP.makeCallAsync("forward",e)}catch(o){console.log("Proxified log: "+o)}}}(t[o]);e.assert||(e.assert=function(){if(arguments.length>0&&!arguments[0]){var t="Assertion failed: "+(arguments.length>1?arguments[1]:"");e.error(t)}}),window.console=e}},t.deproxifyConsole=function(){!window.navigator.isCocoonJS&&Cocoon.nativeAvailable&&"undefined"!=typeof Cocoon.originalConsole&&(window.console=Cocoon.originalConsole,Cocoon.originalConsole=void 0)},t}),Cocoon.define("Cocoon.Touch",function(t){return t.addADivToDisableInput=function(){var t=document.createElement("div");t.id="CocoonJSInputBlockingDiv",t.style.left=0,t.style.top=0,t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.backgroundColor="transparent",
t.style.border="0px solid #000",t.style.zIndex=999999999,document.body.appendChild(t)},t.removeTheDivToEnableInput=function(){var t=document.getElementById("CocoonJSInputBlockingDiv");t&&document.body.removeChild(t)},t.disable=function(){Cocoon.nativeAvailable?window.ext.IDTK_APP.makeCall("disableTouchLayer","CocoonJSView"):navigator.isCocoonJS||Cocoon.App.EmulatedWebViewIFrame||(Cocoon.App.forwardEventsToCocoonJSEnabled=!1,Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.disable();"))},t.enable=function(){Cocoon.nativeAvailable?window.ext.IDTK_APP.makeCall("enableTouchLayer","CocoonJSView"):navigator.isCocoonJS||Cocoon.App.EmulatedWebViewIFrame||(Cocoon.App.forwardEventsToCocoonJSEnabled=!0,Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.enable();"))},t.disableInWebView=function(){Cocoon.nativeAvailable?window.ext.IDTK_APP.makeCall("disableTouchLayer","WebView"):navigator.isCocoonJS||(Cocoon.App.EmulatedWebViewIFrame?Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.disableInWebView();"):Cocoon.Touch.addADivToDisableInput())},t.enableInWebView=function(){Cocoon.nativeAvailable?window.ext.IDTK_APP.makeCall("enableTouchLayer","WebView"):navigator.isCocoonJS||(Cocoon.App.EmulatedWebViewIFrame?Cocoon.Touch.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.enableInWebView();"):Cocoon.Touch.removeTheDivToEnableInput())},t}),Cocoon.define("Cocoon.Utils",function(t){return t.logMemoryInfo=function(){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return Cocoon.callNative("IDTK_APP","logMemoryInfo",arguments)},t.textureReduction=function(t,e,o){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return Cocoon.callNative("IDTK_APP","setDefaultTextureReducerThreshold",arguments)},t.markAsMusic=function(t){if(Cocoon.nativeAvailable)return Cocoon.callNative("IDTK_APP","addForceMusic",arguments)},t.captureScreen=function(t,e,o,n){if(Cocoon.nativeAvailable)return Cocoon.callNative("IDTK_APP","captureScreen",arguments)},t.captureScreenAsync=function(t,e,o,n,i){Cocoon.nativeAvailable&&Cocoon.callNative("IDTK_APP","captureScreen",arguments,!0)},t.setAntialias=function(t){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return Cocoon.callNative("IDTK_APP","setDefaultAntialias",arguments)},t.setWebGLEnabled=function(t){if(Cocoon.nativeAvailable)return Cocoon.callNative("IDTK_APP","setDefaultAntialias",arguments)},t.setNPOTEnabled=function(t){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return window.ext.IDTK_APP.makeCall("setNPOTEnabled",t)},t.setMaxMemory=function(t){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return window.ext.IDTK_APP.makeCall("setMaxMemory",t)},t.CaptureType={EVERYTHING:0,COCOONJS_GL_SURFACE:1,JUST_SYSTEM_VIEWS:2},t.existsPath=function(t,e){return!!Cocoon.nativeAvailable&&Cocoon.callNative("IDTK_APP","existsPath",arguments)},t.setTextCacheSize=function(t){if(Cocoon.nativeAvailable&&navigator.isCocoonJS)return Cocoon.callNative("IDTK_APP","setTextCacheSize",arguments)},t}),Cocoon.define("Cocoon.WebView",function(t){return"undefined"==typeof Cocoon||null===Cocoon?t:"undefined"==typeof Cocoon.App||null===Cocoon.App?t:navigator.isCocoonJS?t:(t.show=function(t,e,o,n){if(Cocoon.App.nativeAvailable)return Cocoon.callNative("IDTK_APP","show",arguments);var i=window.parent.document.getElementById("CocoonJS_App_ForCocoonJS_WebViewDiv");i.style.left=(t?t:i.style.left)+"px",i.style.top=(e?e:i.style.top)+"px",i.style.width=(o?o/window.devicePixelRatio:window.parent.innerWidth)+"px",i.style.height=(n?n/window.devicePixelRatio:window.parent.innerHeight)+"px",i.style.display="block";var s=window.parent.document.getElementById("CocoonJS_App_ForCocoonJS_WebViewIFrame");s.style.width=(o?o/window.devicePixelRatio:window.parent.innerWidth)+"px",s.style.height=(n?n/window.devicePixelRatio:window.parent.innerHeight)+"px"},t.hide=function(){return Cocoon.App.nativeAvailable?Cocoon.callNative("IDTK_APP","hide",arguments):void(window.parent.document.getElementById("CocoonJS_App_ForCocoonJS_WebViewDiv").style.display="none")},t.loadInCocoon=function(t,e,o){if(Cocoon.App.nativeAvailable){var n="ext.IDTK_APP.makeCall('loadPath'";return"undefined"!=typeof t&&(n+=", '"+t+"'","undefined"!=typeof o&&(n+=", '"+o+"'")),n+=");",Cocoon.App.forwardAsync(n)}Cocoon.App.forwardAsync("Cocoon.App.load('"+t+"');")},t.reloadCocoonJS=function(){return Cocoon.App.nativeAvailable?Cocoon.App.forwardAsync("ext.IDTK_APP.makeCall('reload');"):void(navigator.isCocoonJS||window.parent.location.reload())},window.addEventListener("load",function(){if(!Cocoon.App.nativeAvailable&&"CocoonJS_App_ForCocoonJS_WebViewIFrame"==window.name){Cocoon.App.forwardEventsToCocoonJSEnabled=!1;for(var t=["timeStamp","button","type","x","y","pageX","pageY","clientX","clientY","offsetX","offsetY"],e=["dblclick","touchmove","mousemove","touchend","touchcancel","mouseup","touchstart","mousedown","release","dragleft","dragright","swipeleft","swiperight"],o=function(e,o){var n={};for(var i in o){var s=t.indexOf(i);s>=0&&(n[i]=o[i])}var a="Cocoon && Cocoon.App && Cocoon.App.forwardedEventFromTheWebView && Cocoon.App.forwardedEventFromTheWebView("+JSON.stringify(e)+", '"+JSON.stringify(n)+"');";Cocoon.App.forward(a)},n=0;n<e.length;n++)window.addEventListener(e[n],function(t){return function(e){Cocoon.App.forwardEventsToCocoonJSEnabled&&o(t,e)}}(e[n]))}}),t.onLoadInCocoonJSSucceed=new Cocoon.EventHandler("IDTK_APP","App","forwardpageload"),t.onLoadInCocoonJSFailed=new Cocoon.EventHandler("IDTK_APP","App","forwardpagefail"),t)}),Cocoon.define("Cocoon.Widget",function(t){return t.WebDialog=function(){if(Cocoon.App.nativeAvailable)this.webDialogID=window.ext.IDTK_APP.makeCall("createWebDialog");else{var t=document.createElement("iframe");t.id="CocoonJSWebDialogIFrame",t.name="CocoonJSWebDialogIFrame",t.style.cssText="position:fixed;left:0;top:0;bottom:0;right:0; width:100%; height:100%;margin:0;padding:0;";var e=this;t.onload=function(){e.iframeloaded=!0;var t="Cocoon = {}; Cocoon.Widget = {}; Cocoon.Widget.WebDialog = {}; Cocoon.Widget.WebDialog.close = function(){   window.parent.CocoonJSCloseWebDialog();};";e.evalIframe(t);for(var o=0;o<e.pendingEvals.length;++o)e.evalIframe(e.pendingEvals[o]);e.pendingEvals=[]},t.onerror=function(){e.close()},this.iframe=t,this.pendingEvals=[],window.CocoonJSCloseWebDialog=function(){e.close()}}},t.WebDialog.prototype={show:function(t,e){return this.closeCallback=function(){Cocoon.Touch.enable(),e&&e()},Cocoon.App.nativeAvailable?(Cocoon.Touch.disable(),window.ext.IDTK_APP.makeCallAsync("showWebDialog",this.webDialogID,t,this.closeCallback)):(this.iframe.src=t,void document.body.appendChild(this.iframe))},close:function(){return Cocoon.App.nativeAvailable?window.ext.IDTK_APP.makeCallAsync("closeWebDialog",this.webDialogID):(this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),void(this.closeCallback&&this.closeCallback()))},evalIframe:function(t){window.frames.CocoonJSWebDialogIFrame.eval(t)},eval:function(t){return Cocoon.App.nativeAvailable?window.ext.IDTK_APP.makeCallAsync("evalWebDialog",this.webDialogID,t):void(this.iframeloaded?this.evalIframe(t):this.pendingEvals.push(t))}},t})}]);